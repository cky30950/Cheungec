<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仁心中醫診所 - 傳承千年智慧，守護現代健康</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, getDoc, setDoc, collection, getDocs, addDoc, updateDoc, deleteDoc, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase 設定
        const firebaseConfig = {
            apiKey: "AIzaSyBx6RQt7wA2DDnxkQiIfh8ubzpzKYfXWGg",
            authDomain: "clinic-bb064.firebaseapp.com",
            databaseURL: "https://clinic-bb064-default-rtdb.firebaseio.com",
            projectId: "clinic-bb064",
            storageBucket: "clinic-bb064.firebasestorage.app",
            messagingSenderId: "387800418575",
            appId: "1:387800418575:web:4dc6baafbedf640ac1567a",
            measurementId: "G-1KW4XQX10N"
        };

        // 初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // 將 Firebase 實例掛載到 window 物件，供其他腳本使用
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseModules = {
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            doc,
            getDoc,
            setDoc,
            collection,
            getDocs,
            addDoc,
            updateDoc,
            deleteDoc,
            query,
            orderBy
        };

        // 監聽認證狀態變化
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('用戶已登入:', user.email);
                window.currentUser = user;
                updateUIForLoggedInUser();
            } else {
                console.log('用戶已登出');
                window.currentUser = null;
                updateUIForLoggedOutUser();
            }
        });

        // 更新已登入用戶的 UI
        function updateUIForLoggedInUser() {
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (loginBtn && logoutBtn) {
                loginBtn.textContent = '🔐 系統設置';
                logoutBtn.classList.remove('hidden');
                window.isLoggedIn = true;
            }
        }

        // 更新已登出用戶的 UI
        function updateUIForLoggedOutUser() {
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (loginBtn && logoutBtn) {
                loginBtn.textContent = '🔐 系統設置';
                logoutBtn.classList.add('hidden');
                window.isLoggedIn = false;
            }
        }

        // Firebase 資料庫操作函數
        window.FirebaseManager = {
            // 儲存設置到 Firestore
            async saveSettings(settings) {
                try {
                    await setDoc(doc(db, 'clinic-settings', 'main'), {
                        ...settings,
                        updatedAt: new Date(),
                        updatedBy: auth.currentUser?.email || 'system'
                    });
                    console.log('設置已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存設置失敗:', error);
                    return false;
                }
            },

            // 從 Firestore 載入設置
            async loadSettings() {
                try {
                    const docRef = doc(db, 'clinic-settings', 'main');
                    const docSnap = await getDoc(docRef);
                    
                    if (docSnap.exists()) {
                        console.log('從 Firestore 載入設置');
                        return docSnap.data();
                    } else {
                        console.log('Firestore 中沒有設置，使用預設值');
                        return null;
                    }
                } catch (error) {
                    console.error('載入設置失敗:', error);
                    return null;
                }
            },

            // 儲存最新消息
            async saveNews(newsList) {
                try {
                    const newsCollection = collection(db, 'news');
                    
                    // 先清除舊資料（在實際應用中可能需要更精細的處理）
                    const existingNews = await getDocs(newsCollection);
                    for (const doc of existingNews.docs) {
                        await deleteDoc(doc.ref);
                    }
                    
                    // 新增新資料
                    for (const news of newsList) {
                        await addDoc(newsCollection, {
                            ...news,
                            createdAt: new Date(),
                            updatedAt: new Date()
                        });
                    }
                    
                    console.log('最新消息已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存最新消息失敗:', error);
                    return false;
                }
            },

            // 載入最新消息
            async loadNews() {
                try {
                    const newsCollection = collection(db, 'news');
                    const q = query(newsCollection, orderBy('createdAt', 'desc'));
                    const querySnapshot = await getDocs(q);
                    
                    const newsList = [];
                    querySnapshot.forEach((doc) => {
                        newsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入最新消息');
                    return newsList;
                } catch (error) {
                    console.error('載入最新消息失敗:', error);
                    return [];
                }
            },

            // 儲存醫師資料
            async saveDoctors(doctorsList) {
                try {
                    const doctorsCollection = collection(db, 'doctors');
                    
                    // 清除舊資料
                    const existingDoctors = await getDocs(doctorsCollection);
                    for (const doc of existingDoctors.docs) {
                        await deleteDoc(doc.ref);
                    }
                    
                    // 新增新資料
                    for (const doctor of doctorsList) {
                        await addDoc(doctorsCollection, {
                            ...doctor,
                            createdAt: new Date(),
                            updatedAt: new Date()
                        });
                    }
                    
                    console.log('醫師資料已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存醫師資料失敗:', error);
                    return false;
                }
            },

            // 載入醫師資料
            async loadDoctors() {
                try {
                    const doctorsCollection = collection(db, 'doctors');
                    const querySnapshot = await getDocs(doctorsCollection);
                    
                    const doctorsList = [];
                    querySnapshot.forEach((doc) => {
                        doctorsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入醫師資料');
                    return doctorsList;
                } catch (error) {
                    console.error('載入醫師資料失敗:', error);
                    return [];
                }
            },

            // 儲存預約資料
            async saveAppointment(appointmentData) {
                try {
                    const appointmentsCollection = collection(db, 'appointments');
                    const docRef = await addDoc(appointmentsCollection, {
                        ...appointmentData,
                        status: 'pending', // 待確認
                        createdAt: new Date(),
                        updatedAt: new Date()
                    });
                    
                    console.log('預約資料已儲存，ID:', docRef.id);
                    return docRef.id;
                } catch (error) {
                    console.error('儲存預約資料失敗:', error);
                    return null;
                }
            },

            // 載入預約資料
            async loadAppointments() {
                try {
                    const appointmentsCollection = collection(db, 'appointments');
                    const q = query(appointmentsCollection, orderBy('createdAt', 'desc'));
                    const querySnapshot = await getDocs(q);
                    
                    const appointmentsList = [];
                    querySnapshot.forEach((doc) => {
                        appointmentsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入預約資料');
                    return appointmentsList;
                } catch (error) {
                    console.error('載入預約資料失敗:', error);
                    return [];
                }
            },

            // 更新預約狀態
            async updateAppointmentStatus(appointmentId, status) {
                try {
                    const appointmentRef = doc(db, 'appointments', appointmentId);
                    await updateDoc(appointmentRef, {
                        status: status,
                        updatedAt: new Date()
                    });
                    
                    console.log('預約狀態已更新');
                    return true;
                } catch (error) {
                    console.error('更新預約狀態失敗:', error);
                    return false;
                }
            }
        };
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .nav-link {
            position: relative;
            transition: color 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            background-color: #3b82f6;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
            left: 0;
        }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .testimonial-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 導航欄 -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="text-2xl font-bold text-blue-600">🏥 仁心中醫診所</div>
                </div>
                <div class="hidden md:flex md:items-center md:space-x-8">
                    <a href="#home" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">首頁</a>
                    <a href="#about" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">關於我們</a>
                    <a href="#services" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">診療項目</a>
                    <a href="#doctors" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">醫師團隊</a>
                    <a href="#gallery" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">診所環境</a>
                    <a href="#posters" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">宣傳畫報</a>
                    <a href="#news" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">最新消息</a>
                    <a href="#contact" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">聯絡我們</a>
                    <div class="relative">
                        <button id="admin-menu-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition duration-300 flex items-center">
                            ⚙️ 管理
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="admin-dropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border hidden z-50">
                            <a id="backend-link" href="#" target="_blank" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                🖥️ 後台管理
                                <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                                </svg>
                            </a>
                            <button id="login-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                🔐 系統設置
                            </button>
                            <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-b-lg hidden">
                                🚪 登出
                            </button>
                        </div>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-gray-700 hover:text-blue-600">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- 手機版選單 -->
        <div id="mobile-menu" class="md:hidden hidden bg-white border-t">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#home" class="block px-3 py-2 text-gray-700 hover:text-blue-600">首頁</a>
                <a href="#about" class="block px-3 py-2 text-gray-700 hover:text-blue-600">關於我們</a>
                <a href="#services" class="block px-3 py-2 text-gray-700 hover:text-blue-600">診療項目</a>
                <a href="#doctors" class="block px-3 py-2 text-gray-700 hover:text-blue-600">醫師團隊</a>
                <a href="#gallery" class="block px-3 py-2 text-gray-700 hover:text-blue-600">診所環境</a>
                <a href="#posters" class="block px-3 py-2 text-gray-700 hover:text-blue-600">宣傳畫報</a>
                <a href="#news" class="block px-3 py-2 text-gray-700 hover:text-blue-600">最新消息</a>
                <a href="#contact" class="block px-3 py-2 text-gray-700 hover:text-blue-600">聯絡我們</a>
                <button id="mobile-admin-btn" class="block w-full text-left px-3 py-2 text-blue-600 hover:text-blue-800 font-medium">
                    ⚙️ 系統管理
                </button>
            </div>
        </div>
    </nav>

    <!-- 主視覺區 -->
    <section id="home" class="hero-gradient text-white pt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="fade-in">
                    <h1 class="text-4xl md:text-6xl font-bold mb-6">
                        傳承千年智慧<br>
                        <span class="text-cyan-300">守護現代健康</span>
                    </h1>
                    <p class="text-xl mb-8 text-blue-100">
                        結合傳統中醫精髓與現代醫學技術，為您提供全方位的健康照護服務。
                        專業醫師團隊，用心呵護每一位患者的健康。
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button onclick="scrollToSection('contact')" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition duration-300">
                            立即預約
                        </button>
                        <button onclick="scrollToSection('services')" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-blue-600 transition duration-300">
                            了解更多
                        </button>
                    </div>
                </div>
                <div class="fade-in">
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                        <h3 class="text-2xl font-bold mb-6 text-center">診所資訊</h3>
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">📍</span>
                                <span>台北市中正區健康路123號</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">📞</span>
                                <span>(02) 2345-6789</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">🕒</span>
                                <span>週一至週六 09:00-21:00</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">🚇</span>
                                <span>捷運中正紀念堂站 2號出口</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 關於我們 -->
    <section id="about" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">關於仁心中醫診所</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    秉承「仁心仁術，濟世救人」的理念，我們致力於傳承中醫文化，結合現代醫學技術，為患者提供最優質的醫療服務。
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="fade-in">
                    <div class="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">我們的使命</h3>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🎯</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">專業醫療</h4>
                                    <p class="text-gray-600">提供專業、安全、有效的中醫診療服務</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">❤️</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">用心關懷</h4>
                                    <p class="text-gray-600">以患者為中心，提供溫馨貼心的醫療體驗</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🌱</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">持續創新</h4>
                                    <p class="text-gray-600">結合傳統智慧與現代科技，不斷提升醫療品質</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="fade-in">
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🏆</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">專業認證</h4>
                            <p class="text-gray-600">所有醫師均具備國家中醫師執照，並持續接受專業培訓</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🌿</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">天然療法</h4>
                            <p class="text-gray-600">採用純天然中藥材，安全無副作用的治療方式</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🤝</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">個人化治療</h4>
                            <p class="text-gray-600">根據每位患者的體質和症狀，制定專屬治療方案</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 診療項目 -->
    <section id="services" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">診療項目</h2>
                <p class="text-xl text-gray-600">
                    提供全方位的中醫診療服務，守護您的健康
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🩺</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">內科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 感冒咳嗽、過敏性鼻炎</li>
                        <li>• 胃腸疾病、消化不良</li>
                        <li>• 失眠、焦慮、憂鬱</li>
                        <li>• 高血壓、糖尿病調理</li>
                        <li>• 慢性疲勞症候群</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🦴</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">骨傷科</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 頸肩腰腿痛</li>
                        <li>• 關節炎、風濕痛</li>
                        <li>• 運動傷害復健</li>
                        <li>• 椎間盤突出</li>
                        <li>• 骨質疏鬆調理</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">👩‍⚕️</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">婦科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 月經不調、痛經</li>
                        <li>• 更年期症候群</li>
                        <li>• 不孕症調理</li>
                        <li>• 產後調理</li>
                        <li>• 子宮肌瘤、卵巢囊腫</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">👶</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">兒科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 小兒感冒、發燒</li>
                        <li>• 過敏性疾病</li>
                        <li>• 消化不良、厭食</li>
                        <li>• 生長發育調理</li>
                        <li>• 注意力不集中</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🌸</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">美容養生</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 美容針灸</li>
                        <li>• 減重瘦身</li>
                        <li>• 皮膚問題調理</li>
                        <li>• 抗衰老保養</li>
                        <li>• 體質調理</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">⚡</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">特色療法</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 針灸治療</li>
                        <li>• 推拿按摩</li>
                        <li>• 拔罐刮痧</li>
                        <li>• 艾灸療法</li>
                        <li>• 中藥薰蒸</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- 醫師團隊 -->
    <section id="doctors" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">專業醫師團隊</h2>
                <p class="text-xl text-gray-600">
                    經驗豐富的中醫師，為您提供專業的醫療服務
                </p>
            </div>

            <div id="doctors-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- 醫師卡片將由 JavaScript 動態生成 -->
            </div>
        </div>
    </section>

    <!-- 診所環境 -->
    <section id="gallery" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">診所環境</h2>
                <p class="text-xl text-gray-600">
                    舒適溫馨的就診環境，讓您感受到家的溫暖
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-blue-100 to-blue-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🏥</div>
                            <p class="text-gray-700 font-medium">診所外觀</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">現代化外觀設計</h3>
                        <p class="text-gray-600">簡約現代的建築風格，營造專業醫療形象</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🛋️</div>
                            <p class="text-gray-700 font-medium">候診區</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">舒適候診空間</h3>
                        <p class="text-gray-600">寬敞明亮的候診區，提供舒適的等候環境</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-purple-100 to-purple-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🏠</div>
                            <p class="text-gray-700 font-medium">診療室</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">專業診療空間</h3>
                        <p class="text-gray-600">配備完善的診療設備，確保診療品質</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-yellow-100 to-yellow-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">💊</div>
                            <p class="text-gray-700 font-medium">藥房</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">現代化藥房</h3>
                        <p class="text-gray-600">嚴格品管的中藥材，確保用藥安全</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-red-100 to-red-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🌿</div>
                            <p class="text-gray-700 font-medium">治療室</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">特色治療空間</h3>
                        <p class="text-gray-600">針灸、推拿等特色療法的專用空間</p>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg overflow-hidden card-hover fade-in">
                    <div class="h-48 bg-gradient-to-br from-indigo-100 to-indigo-200 flex items-center justify-center">
                        <div class="text-center">
                            <div class="text-4xl mb-2">🧘</div>
                            <p class="text-gray-700 font-medium">休息區</p>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-gray-900 mb-2">靜心休息空間</h3>
                        <p class="text-gray-600">治療後的休息區域，讓身心得到充分放鬆</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 宣傳畫報 -->
    <section id="posters" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">健康宣傳畫報</h2>
                <p class="text-xl text-gray-600">
                    分享中醫養生知識，傳播健康生活理念
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">🍃</div>
                        <h3 class="text-xl font-bold text-gray-900">春季養生</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">春季養肝正當時</p>
                        <ul class="text-sm space-y-1">
                            <li>• 早睡早起，順應自然</li>
                            <li>• 多食綠色蔬菜</li>
                            <li>• 適度運動，舒展筋骨</li>
                            <li>• 保持心情愉悅</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-red-50 to-red-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">☀️</div>
                        <h3 class="text-xl font-bold text-gray-900">夏季養心</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">夏季養心防暑熱</p>
                        <ul class="text-sm space-y-1">
                            <li>• 清淡飲食，多喝水</li>
                            <li>• 避免過度勞累</li>
                            <li>• 午休片刻養精神</li>
                            <li>• 心靜自然涼</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-yellow-50 to-yellow-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">🍂</div>
                        <h3 class="text-xl font-bold text-gray-900">秋季養肺</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">秋季養肺潤燥氣</p>
                        <ul class="text-sm space-y-1">
                            <li>• 多食白色食物</li>
                            <li>• 保持室內濕度</li>
                            <li>• 深呼吸練習</li>
                            <li>• 預防感冒</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">❄️</div>
                        <h3 class="text-xl font-bold text-gray-900">冬季養腎</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">冬季養腎藏精氣</p>
                        <ul class="text-sm space-y-1">
                            <li>• 早睡晚起，保存陽氣</li>
                            <li>• 溫補食物為主</li>
                            <li>• 適度運動，不宜過激</li>
                            <li>• 保暖防寒</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-green-50 to-green-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">🧘‍♀️</div>
                        <h3 class="text-xl font-bold text-gray-900">穴位按摩</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">日常保健穴位</p>
                        <ul class="text-sm space-y-1">
                            <li>• 足三里：強身健體</li>
                            <li>• 合谷穴：緩解頭痛</li>
                            <li>• 太衝穴：疏肝理氣</li>
                            <li>• 湧泉穴：補腎益精</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-center mb-6">
                        <div class="text-5xl mb-4">🍵</div>
                        <h3 class="text-xl font-bold text-gray-900">養生茶飲</h3>
                    </div>
                    <div class="space-y-3 text-gray-700">
                        <p class="font-semibold">四季養生茶推薦</p>
                        <ul class="text-sm space-y-1">
                            <li>• 春：玫瑰花茶疏肝</li>
                            <li>• 夏：綠茶清熱解毒</li>
                            <li>• 秋：烏龍茶潤燥</li>
                            <li>• 冬：紅茶溫陽暖胃</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 最新消息 -->
    <section id="news" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">最新消息</h2>
                <p class="text-xl text-gray-600">
                    掌握診所最新動態與健康資訊
                </p>
            </div>

            <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- 最新消息將由 JavaScript 動態生成 -->
            </div>
        </div>
    </section>

    <!-- 患者見證 -->
    <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">患者見證</h2>
                <p class="text-xl text-gray-600">
                    真實的治療經驗分享
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-blue-600 font-bold">王</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">王小姐</h4>
                            <p class="text-gray-600 text-sm">上班族</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "長期的肩須痠痛困擾我很久，經過王醫師的針灸治療和中藥調理，現在症狀明顯改善了。醫師很專業，護理人員也很親切！"
                    </p>
                </div>

                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-green-600 font-bold">李</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">李先生</h4>
                            <p class="text-gray-600 text-sm">退休人員</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "糖尿病的血糖控制一直不理想，在這裡接受中醫調理後，血糖穩定了很多，整個人的精神狀態也變好了。"
                    </p>
                </div>

                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-purple-600 font-bold">陳</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">陳太太</h4>
                            <p class="text-gray-600 text-sm">家庭主婦</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "更年期的各種不適症狀讓我很困擾，李醫師的治療讓我重新找回了生活品質。診所環境很舒適，服務也很周到。"
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- 聯絡我們 -->
    <section id="contact" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">聯絡我們</h2>
                <p class="text-xl text-gray-600">
                    歡迎預約諮詢，我們將竭誠為您服務
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- 聯絡資訊 -->
                <div class="fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">診所資訊</h3>
                        
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📍</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">地址</h4>
                                    <p class="text-gray-600">台北市中正區健康路123號1-3樓</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📞</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">電話</h4>
                                    <p class="text-gray-600">(02) 2345-6789</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📧</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">電子信箱</h4>
                                    <p class="text-gray-600">info@renxin-tcm.com.tw</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🕒</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">門診時間</h4>
                                    <div class="text-gray-600 space-y-1">
                                        <p>週一至週五：09:00-12:00, 14:00-17:00, 18:00-21:00</p>
                                        <p>週六：09:00-12:00, 14:00-17:00</p>
                                        <p>週日：休診</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🚇</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">交通資訊</h4>
                                    <div class="text-gray-600 space-y-1">
                                        <p>捷運：中正紀念堂站2號出口，步行3分鐘</p>
                                        <p>公車：15, 18, 236, 295路線</p>
                                        <p>停車：診所附近有多個付費停車場</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 預約表單 -->
                <div class="fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">線上預約</h3>
                        
                        <form id="appointment-form" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">姓名 *</label>
                                    <input type="text" id="patient-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入您的姓名">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">電話 *</label>
                                    <input type="tel" id="patient-phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入聯絡電話">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">電子信箱</label>
                                <input type="email" id="patient-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入電子信箱">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">希望預約醫師</label>
                                    <select id="preferred-doctor" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="">請選擇醫師</option>
                                        <option value="王志明">王志明 院長</option>
                                        <option value="李美華">李美華 醫師</option>
                                        <option value="陳建宏">陳建宏 醫師</option>
                                        <option value="張雅芳">張雅芳 醫師</option>
                                        <option value="林志強">林志強 醫師</option>
                                        <option value="黃淑惠">黃淑惠 醫師</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">希望預約日期</label>
                                    <input type="date" id="preferred-date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">症狀描述</label>
                                <textarea id="symptoms" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請簡述您的症狀或需求"></textarea>
                            </div>
                            
                            <button type="submit" id="submit-appointment" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                                <span id="submit-text">提交預約申請</span>
                                <div id="submit-loading" class="loading ml-2 hidden"></div>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 頁尾 -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="text-2xl font-bold mb-4">🏥 仁心中醫診所</div>
                    <p class="text-gray-400 mb-4">傳承千年智慧，守護現代健康</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">📘</a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">📷</a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">🐦</a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">快速連結</h3>
                    <ul class="space-y-2">
                        <li><a href="#about" class="text-gray-400 hover:text-white transition duration-300">關於我們</a></li>
                        <li><a href="#services" class="text-gray-400 hover:text-white transition duration-300">診療項目</a></li>
                        <li><a href="#doctors" class="text-gray-400 hover:text-white transition duration-300">醫師團隊</a></li>
                        <li><a href="#news" class="text-gray-400 hover:text-white transition duration-300">最新消息</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">診療項目</h3>
                    <ul class="space-y-2">
                        <li><span class="text-gray-400">內科調理</span></li>
                        <li><span class="text-gray-400">骨傷科</span></li>
                        <li><span class="text-gray-400">婦科調理</span></li>
                        <li><span class="text-gray-400">兒科調理</span></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">聯絡資訊</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li>📍 台北市中正區健康路123號</li>
                        <li>📞 (02) 2345-6789</li>
                        <li>📧 info@renxin-tcm.com.tw</li>
                        <li>🕒 週一至週六 09:00-21:00</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8 text-center">
                <p class="text-gray-400">© 2024 仁心中醫診所. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- 浮動預約按鈕 -->
    <button onclick="scrollToSection('contact')" class="floating-btn bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300">
        📞 立即預約
    </button>

    <!-- 登入對話框 -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">管理員登入</h2>
                        <button id="close-login" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="login-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">電子信箱</label>
                            <input type="email" id="admin-email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入管理員信箱">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">密碼</label>
                            <input type="password" id="admin-password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入密碼">
                        </div>
                        
                        <div id="login-error" class="text-red-600 text-sm hidden">登入失敗，請檢查帳號密碼</div>
                        
                        <button type="submit" id="login-submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                            <span id="login-text">登入</span>
                            <div id="login-loading" class="loading ml-2 hidden"></div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 系統設置面板 -->
    <div id="settings-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-900">系統設置</h2>
                    <button id="close-settings" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- 設置分頁 -->
                    <div class="border-b mb-6">
                        <nav class="flex flex-wrap gap-4">
                            <button class="settings-tab active py-2 px-1 border-b-2 border-blue-600 text-blue-600 font-medium" data-tab="basic">基本設置</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="doctors">醫師管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="news">消息管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="appointments">預約管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="sync">資料同步</button>
                        </nav>
                    </div>

                    <!-- 基本設置分頁 -->
                    <div id="basic-tab" class="settings-content">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">基本設置</h3>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">診所名稱</label>
                                <input type="text" id="clinic-name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="仁心中醫診所">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">診所地址</label>
                                <input type="text" id="clinic-address" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="台北市中正區健康路123號">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">聯絡電話</label>
                                <input type="text" id="clinic-phone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="(02) 2345-6789">
                            </div>
                        </div>
                    </div>

                    <!-- 醫師管理分頁 -->
                    <div id="doctors-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">醫師管理</h3>
                                <button id="add-doctor" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增醫師
                                </button>
                            </div>
                            
                            <div id="doctors-management" class="space-y-4">
                                <!-- 醫師管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 消息管理分頁 -->
                    <div id="news-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">消息管理</h3>
                                <button id="add-news" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增消息
                                </button>
                            </div>
                            
                            <div id="news-management" class="space-y-4">
                                <!-- 消息管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 預約管理分頁 -->
                    <div id="appointments-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">預約管理</h3>
                                <button id="refresh-appointments" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center">
                                    <span>重新整理</span>
                                    <div id="refresh-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                            
                            <div id="appointments-list" class="space-y-4">
                                <!-- 預約列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 資料同步分頁 -->
                    <div id="sync-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">資料同步</h3>
                            
                            <div class="grid grid-cols-1 gap-4">
                                <button id="sync-from-firebase" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                                    <span>🔄 重新載入 Firebase 資料</span>
                                    <div id="sync-from-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                            
                            <div id="sync-status" class="p-4 rounded-lg bg-gray-50 text-sm text-gray-600">
                                所有資料都會即時保存到 Firebase。使用上方按鈕可重新載入最新資料。
                            </div>
                        </div>
                    </div>
                    
                    <!-- 操作按鈕 -->
                    <div class="mt-8 flex justify-between">
                        <button id="save-settings" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center">
                            <span>保存設置</span>
                            <div id="save-loading" class="loading ml-2 hidden"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全域變數
        let currentDoctors = [];
        let currentNews = [];

        // 等待 Firebase 初始化完成
        window.addEventListener('load', async () => {
            // 初始化應用
            await initializeApp();
        });

        // 應用初始化
        async function initializeApp() {
            console.log('初始化應用...');
            
            // 從 Firebase 載入設置
            if (window.FirebaseManager) {
                try {
                    const firebaseSettings = await window.FirebaseManager.loadSettings();
                    if (firebaseSettings) {
                        console.log('從 Firebase 載入設置');
                        applySettings(firebaseSettings);
                    } else {
                        console.log('Firebase 中沒有設置，使用預設值');
                        const defaultSettings = getDefaultSettings();
                        applySettings(defaultSettings);
                        // 將預設設置保存到 Firebase
                        await window.FirebaseManager.saveSettings(defaultSettings);
                    }

                    // 載入醫師資料
                    const doctors = await window.FirebaseManager.loadDoctors();
                    if (doctors.length > 0) {
                        currentDoctors = doctors;
                    } else {
                        currentDoctors = getDefaultDoctors();
                        await window.FirebaseManager.saveDoctors(currentDoctors);
                    }
                    renderDoctors();

                    // 載入最新消息
                    const news = await window.FirebaseManager.loadNews();
                    if (news.length > 0) {
                        currentNews = news;
                    } else {
                        currentNews = getDefaultNews();
                        await window.FirebaseManager.saveNews(currentNews);
                    }
                    renderNews();

                } catch (error) {
                    console.error('載入 Firebase 設置失敗，使用預設設置:', error);
                    const defaultSettings = getDefaultSettings();
                    applySettings(defaultSettings);
                    currentDoctors = getDefaultDoctors();
                    currentNews = getDefaultNews();
                    renderDoctors();
                    renderNews();
                }
            } else {
                // Firebase 未初始化時使用預設設置
                const defaultSettings = getDefaultSettings();
                applySettings(defaultSettings);
                currentDoctors = getDefaultDoctors();
                currentNews = getDefaultNews();
                renderDoctors();
                renderNews();
            }

            // 初始化事件監聽器
            initializeEventListeners();
        }

        // 預設設置
        function getDefaultSettings() {
            return {
                clinicName: '仁心中醫診所',
                clinicAddress: '台北市中正區健康路123號',
                clinicPhone: '(02) 2345-6789',
                clinicEmail: 'info@renxin-tcm.com.tw'
            };
        }

        // 預設醫師資料
        function getDefaultDoctors() {
            return [
                {
                    name: '王志明',
                    title: '院長',
                    specialty: '內科、針灸',
                    experience: '30年臨床經驗',
                    education: '中國醫藥大學中醫學系',
                    description: '專精於內科疾病治療，擅長運用針灸療法治療各種慢性疾病。'
                },
                {
                    name: '李美華',
                    title: '主治醫師',
                    specialty: '婦科、兒科',
                    experience: '25年臨床經驗',
                    education: '長庚大學中醫學系',
                    description: '專門治療婦科疾病及小兒科疾病，深受患者信賴。'
                },
                {
                    name: '陳建宏',
                    title: '主治醫師',
                    specialty: '骨傷科、推拿',
                    experience: '20年臨床經驗',
                    education: '義守大學中醫學系',
                    description: '專精於骨傷科治療，結合推拿手法，療效顯著。'
                },
                {
                    name: '張雅芳',
                    title: '主治醫師',
                    specialty: '皮膚科、美容',
                    experience: '15年臨床經驗',
                    education: '慈濟大學中醫學系',
                    description: '專門治療皮膚疾病，並提供中醫美容調理服務。'
                },
                {
                    name: '林志強',
                    title: '主治醫師',
                    specialty: '腫瘤科、免疫',
                    experience: '18年臨床經驗',
                    education: '中山醫學大學中醫學系',
                    description: '專精於腫瘤輔助治療及免疫系統調理。'
                },
                {
                    name: '黃淑惠',
                    title: '主治醫師',
                    specialty: '精神科、睡眠',
                    experience: '12年臨床經驗',
                    education: '台北醫學大學中醫學系',
                    description: '專門治療失眠、焦慮等精神相關疾病。'
                }
            ];
        }

        // 預設最新消息
        function getDefaultNews() {
            return [
                {
                    title: '春季養生講座',
                    date: '2024-03-15',
                    category: '活動公告',
                    content: '本診所將於3月20日舉辦春季養生講座，歡迎民眾踴躍參加。',
                    important: true
                },
                {
                    title: '新增夜間門診',
                    date: '2024-03-10',
                    category: '門診異動',
                    content: '為服務更多患者，本診所新增週一至週五夜間門診時段。',
                    important: false
                },
                {
                    title: '中秋節門診調整',
                    date: '2024-03-05',
                    category: '門診異動',
                    content: '中秋節連假期間門診時間調整，請患者注意。',
                    important: false
                },
                {
                    title: '健保卡更新提醒',
                    date: '2024-03-01',
                    category: '重要通知',
                    content: '請患者記得攜帶最新的健保卡就診。',
                    important: true
                }
            ];
        }

        // 應用設置到頁面
        function applySettings(settings) {
            // 更新診所名稱
            document.querySelectorAll('.text-2xl.font-bold').forEach(el => {
                if (el.textContent.includes('🏥') || el.textContent.includes('仁心中醫診所')) {
                    el.innerHTML = `🏥 ${settings.clinicName}`;
                }
            });

            // 更新聯絡資訊
            document.querySelectorAll('span').forEach(el => {
                if (el.textContent.includes('台北市中正區健康路123號')) {
                    el.textContent = settings.clinicAddress;
                }
                if (el.textContent.includes('(02) 2345-6789')) {
                    el.textContent = settings.clinicPhone;
                }
            });

            // 更新設置面板的值
            if (document.getElementById('clinic-name')) {
                document.getElementById('clinic-name').value = settings.clinicName;
                document.getElementById('clinic-address').value = settings.clinicAddress;
                document.getElementById('clinic-phone').value = settings.clinicPhone;
            }
        }

        // 渲染醫師列表
        function renderDoctors() {
            const container = document.getElementById('doctors-container');
            container.innerHTML = '';

            currentDoctors.forEach((doctor, index) => {
                const doctorCard = document.createElement('div');
                doctorCard.className = 'bg-white rounded-xl shadow-lg p-8 card-hover fade-in';
                
                doctorCard.innerHTML = `
                    <div class="text-center mb-6">
                        <div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                            <span class="text-2xl font-bold text-blue-600">${doctor.name.charAt(0)}</span>
                        </div>
                        <h3 class="text-xl font-bold text-gray-900">${doctor.name}</h3>
                        <p class="text-blue-600 font-medium">${doctor.title}</p>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">🎯</span>
                            <span class="text-gray-700">${doctor.specialty}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">📚</span>
                            <span class="text-gray-700">${doctor.experience}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">🎓</span>
                            <span class="text-gray-700">${doctor.education}</span>
                        </div>
                    </div>
                    
                    <div class="mt-4 pt-4 border-t">
                        <p class="text-gray-600 text-sm">${doctor.description}</p>
                    </div>
                `;
                
                container.appendChild(doctorCard);
            });
        }

        // 渲染最新消息
        function renderNews() {
            const container = document.getElementById('news-container');
            container.innerHTML = '';

            currentNews.forEach((news, index) => {
                const newsCard = document.createElement('div');
                newsCard.className = 'bg-white rounded-xl shadow-lg p-6 card-hover fade-in';
                
                const importantBadge = news.important ? 
                    '<span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold">重要</span>' : '';
                
                newsCard.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">${news.category}</span>
                        ${importantBadge}
                    </div>
                    
                    <h3 class="text-lg font-bold text-gray-900 mb-2">${news.title}</h3>
                    <p class="text-gray-600 mb-4">${news.content}</p>
                    
                    <div class="flex justify-between items-center text-sm text-gray-500">
                        <span>📅 ${news.date}</span>
                        <button class="text-blue-600 hover:text-blue-800">閱讀更多</button>
                    </div>
                `;
                
                container.appendChild(newsCard);
            });
        }

        // 初始化事件監聽器
        function initializeEventListeners() {
            // 管理選單功能
            const adminMenuBtn = document.getElementById('admin-menu-btn');
            const adminDropdown = document.getElementById('admin-dropdown');
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const loginModal = document.getElementById('login-modal');
            const closeLogin = document.getElementById('close-login');
            const loginForm = document.getElementById('login-form');
            const settingsPanel = document.getElementById('settings-panel');
            const closeSettings = document.getElementById('close-settings');

            // 管理選單切換
            adminMenuBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                adminDropdown.classList.toggle('hidden');
            });

            // 點擊其他地方關閉選單
            document.addEventListener('click', () => {
                adminDropdown.classList.add('hidden');
            });

            // 登入按鈕
            loginBtn.addEventListener('click', () => {
                if (window.isLoggedIn) {
                    settingsPanel.classList.remove('hidden');
                    loadAppointments(); // 載入預約資料
                } else {
                    loginModal.classList.remove('hidden');
                }
                adminDropdown.classList.add('hidden');
            });

            // 登出按鈕
            logoutBtn.addEventListener('click', async () => {
                try {
                    await window.firebaseModules.signOut(window.firebaseAuth);
                    console.log('已登出');
                } catch (error) {
                    console.error('登出失敗:', error);
                }
                adminDropdown.classList.add('hidden');
            });

            // 關閉登入對話框
            closeLogin.addEventListener('click', () => {
                loginModal.classList.add('hidden');
                document.getElementById('login-error').classList.add('hidden');
            });

            // 關閉設置面板
            closeSettings.addEventListener('click', () => {
                settingsPanel.classList.add('hidden');
            });

            // 登入表單提交
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const email = document.getElementById('admin-email').value;
                const password = document.getElementById('admin-password').value;
                const loginError = document.getElementById('login-error');
                const loginText = document.getElementById('login-text');
                const loginLoading = document.getElementById('login-loading');

                // 顯示載入狀態
                loginText.textContent = '登入中...';
                loginLoading.classList.remove('hidden');
                loginError.classList.add('hidden');

                try {
                    await window.firebaseModules.signInWithEmailAndPassword(window.firebaseAuth, email, password);
                    loginModal.classList.add('hidden');
                    settingsPanel.classList.remove('hidden');
                    loadAppointments(); // 載入預約資料
                } catch (error) {
                    console.error('登入失敗:', error);
                    loginError.textContent = '登入失敗：' + error.message;
                    loginError.classList.remove('hidden');
                } finally {
                    // 恢復按鈕狀態
                    loginText.textContent = '登入';
                    loginLoading.classList.add('hidden');
                }
            });

            // 預約表單提交
            const appointmentForm = document.getElementById('appointment-form');
            appointmentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                await submitAppointment();
            });

            // 設置分頁切換
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetTab = tab.dataset.tab;
                    
                    // 更新分頁按鈕狀態
                    document.querySelectorAll('.settings-tab').forEach(t => {
                        t.classList.remove('active', 'border-blue-600', 'text-blue-600');
                        t.classList.add('border-transparent', 'text-gray-500');
                    });
                    tab.classList.add('active', 'border-blue-600', 'text-blue-600');
                    tab.classList.remove('border-transparent', 'text-gray-500');
                    
                    // 顯示對應內容
                    document.querySelectorAll('.settings-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(`${targetTab}-tab`).classList.remove('hidden');

                    // 載入對應資料
                    if (targetTab === 'doctors') {
                        renderDoctorsManagement();
                    } else if (targetTab === 'news') {
                        renderNewsManagement();
                    }
                });
            });

            // 保存設置
            document.getElementById('save-settings').addEventListener('click', async () => {
                await saveSettings();
            });

            // 重新整理預約
            document.getElementById('refresh-appointments').addEventListener('click', async () => {
                await loadAppointments();
            });

            // 從 Firebase 重新載入
            document.getElementById('sync-from-firebase').addEventListener('click', async () => {
                await reloadFromFirebase();
            });

            // 新增醫師
            document.getElementById('add-doctor').addEventListener('click', () => {
                addNewDoctor();
            });

            // 新增消息
            document.getElementById('add-news').addEventListener('click', () => {
                addNewNews();
            });
        }

        // 渲染醫師管理
        function renderDoctorsManagement() {
            const container = document.getElementById('doctors-management');
            container.innerHTML = '';

            currentDoctors.forEach((doctor, index) => {
                const doctorItem = document.createElement('div');
                doctorItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                doctorItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-bold text-gray-900 mb-2">${doctor.name} - ${doctor.title}</h4>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>專長:</strong> ${doctor.specialty}</p>
                                <p><strong>經驗:</strong> ${doctor.experience}</p>
                                <p><strong>學歷:</strong> ${doctor.education}</p>
                                <p><strong>簡介:</strong> ${doctor.description}</p>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editDoctor(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deleteDoctor(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(doctorItem);
            });
        }

        // 渲染消息管理
        function renderNewsManagement() {
            const container = document.getElementById('news-management');
            container.innerHTML = '';

            currentNews.forEach((news, index) => {
                const newsItem = document.createElement('div');
                newsItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                const importantBadge = news.important ? 
                    '<span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold ml-2">重要</span>' : '';
                
                newsItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h4 class="font-bold text-gray-900">${news.title}</h4>
                                ${importantBadge}
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>分類:</strong> ${news.category}</p>
                                <p><strong>日期:</strong> ${news.date}</p>
                                <p><strong>內容:</strong> ${news.content}</p>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editNews(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deleteNews(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(newsItem);
            });
        }

        // 新增醫師
        function addNewDoctor() {
            const name = prompt('請輸入醫師姓名:');
            if (!name) return;
            
            const title = prompt('請輸入職稱:') || '主治醫師';
            const specialty = prompt('請輸入專長:') || '';
            const experience = prompt('請輸入經驗:') || '';
            const education = prompt('請輸入學歷:') || '';
            const description = prompt('請輸入簡介:') || '';

            const newDoctor = {
                name,
                title,
                specialty,
                experience,
                education,
                description
            };

            currentDoctors.push(newDoctor);
            renderDoctors();
            renderDoctorsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveDoctors(currentDoctors);
            }
        }

        // 編輯醫師
        function editDoctor(index) {
            const doctor = currentDoctors[index];
            
            const name = prompt('請輸入醫師姓名:', doctor.name);
            if (!name) return;
            
            const title = prompt('請輸入職稱:', doctor.title);
            const specialty = prompt('請輸入專長:', doctor.specialty);
            const experience = prompt('請輸入經驗:', doctor.experience);
            const education = prompt('請輸入學歷:', doctor.education);
            const description = prompt('請輸入簡介:', doctor.description);

            currentDoctors[index] = {
                name,
                title: title || doctor.title,
                specialty: specialty || doctor.specialty,
                experience: experience || doctor.experience,
                education: education || doctor.education,
                description: description || doctor.description
            };

            renderDoctors();
            renderDoctorsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveDoctors(currentDoctors);
            }
        }

        // 刪除醫師
        function deleteDoctor(index) {
            if (confirm('確定要刪除這位醫師嗎？')) {
                currentDoctors.splice(index, 1);
                renderDoctors();
                renderDoctorsManagement();
                
                // 保存到 Firebase
                if (window.FirebaseManager) {
                    window.FirebaseManager.saveDoctors(currentDoctors);
                }
            }
        }

        // 新增消息
        function addNewNews() {
            const title = prompt('請輸入消息標題:');
            if (!title) return;
            
            const category = prompt('請輸入分類:') || '一般公告';
            const content = prompt('請輸入內容:') || '';
            const important = confirm('是否為重要消息？');
            const date = new Date().toISOString().split('T')[0];

            const newNews = {
                title,
                category,
                content,
                important,
                date
            };

            currentNews.unshift(newNews); // 新消息放在最前面
            renderNews();
            renderNewsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveNews(currentNews);
            }
        }

        // 編輯消息
        function editNews(index) {
            const news = currentNews[index];
            
            const title = prompt('請輸入消息標題:', news.title);
            if (!title) return;
            
            const category = prompt('請輸入分類:', news.category);
            const content = prompt('請輸入內容:', news.content);
            const important = confirm('是否為重要消息？');

            currentNews[index] = {
                ...news,
                title,
                category: category || news.category,
                content: content || news.content,
                important
            };

            renderNews();
            renderNewsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveNews(currentNews);
            }
        }

        // 刪除消息
        function deleteNews(index) {
            if (confirm('確定要刪除這則消息嗎？')) {
                currentNews.splice(index, 1);
                renderNews();
                renderNewsManagement();
                
                // 保存到 Firebase
                if (window.FirebaseManager) {
                    window.FirebaseManager.saveNews(currentNews);
                }
            }
        }

        // 提交預約
        async function submitAppointment() {
            const submitText = document.getElementById('submit-text');
            const submitLoading = document.getElementById('submit-loading');
            
            // 顯示載入狀態
            submitText.textContent = '提交中...';
            submitLoading.classList.remove('hidden');

            try {
                const appointmentData = {
                    patientName: document.getElementById('patient-name').value,
                    patientPhone: document.getElementById('patient-phone').value,
                    patientEmail: document.getElementById('patient-email').value,
                    preferredDoctor: document.getElementById('preferred-doctor').value,
                    preferredDate: document.getElementById('preferred-date').value,
                    symptoms: document.getElementById('symptoms').value
                };

                if (window.FirebaseManager) {
                    const appointmentId = await window.FirebaseManager.saveAppointment(appointmentData);
                    if (appointmentId) {
                        alert('預約申請已提交成功！我們將盡快與您聯繫確認預約時間。\n\n預約編號：' + appointmentId);
                        document.getElementById('appointment-form').reset();
                    } else {
                        throw new Error('儲存預約資料失敗');
                    }
                } else {
                    // 如果 Firebase 不可用，顯示提示訊息
                    alert('感謝您的預約申請！我們將盡快與您聯繫確認預約時間。\n\n實際預約請致電：(02) 2345-6789');
                    document.getElementById('appointment-form').reset();
                }
            } catch (error) {
                console.error('提交預約失敗:', error);
                alert('提交預約時發生錯誤，請稍後再試或直接致電診所。');
            } finally {
                // 恢復按鈕狀態
                submitText.textContent = '提交預約申請';
                submitLoading.classList.add('hidden');
            }
        }

        // 載入預約資料
        async function loadAppointments() {
            const refreshLoading = document.getElementById('refresh-loading');
            const appointmentsList = document.getElementById('appointments-list');
            
            refreshLoading.classList.remove('hidden');
            
            try {
                if (window.FirebaseManager) {
                    const appointments = await window.FirebaseManager.loadAppointments();
                    renderAppointmentsList(appointments);
                } else {
                    appointmentsList.innerHTML = '<p class="text-gray-500">Firebase 未連接</p>';
                }
            } catch (error) {
                console.error('載入預約資料失敗:', error);
                appointmentsList.innerHTML = '<p class="text-red-500">載入預約資料失敗</p>';
            } finally {
                refreshLoading.classList.add('hidden');
            }
        }

        // 渲染預約列表
        function renderAppointmentsList(appointments) {
            const appointmentsList = document.getElementById('appointments-list');
            appointmentsList.innerHTML = '';
            
            if (appointments.length === 0) {
                appointmentsList.innerHTML = '<p class="text-gray-500">目前沒有預約資料</p>';
                return;
            }
            
            appointments.forEach(appointment => {
                const appointmentItem = document.createElement('div');
                appointmentItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                const statusColor = {
                    'pending': 'yellow',
                    'confirmed': 'green',
                    'cancelled': 'red',
                    'completed': 'blue'
                }[appointment.status] || 'gray';
                
                const statusText = {
                    'pending': '待確認',
                    'confirmed': '已確認',
                    'cancelled': '已取消',
                    'completed': '已完成'
                }[appointment.status] || '未知';
                
                appointmentItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h4 class="font-bold text-gray-900 mr-4">${appointment.patientName}</h4>
                                <span class="bg-${statusColor}-100 text-${statusColor}-800 px-2 py-1 rounded text-xs font-semibold">
                                    ${statusText}
                                </span>
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>電話:</strong> ${appointment.patientPhone}</p>
                                ${appointment.patientEmail ? `<p><strong>信箱:</strong> ${appointment.patientEmail}</p>` : ''}
                                ${appointment.preferredDoctor ? `<p><strong>指定醫師:</strong> ${appointment.preferredDoctor}</p>` : ''}
                                ${appointment.preferredDate ? `<p><strong>希望日期:</strong> ${appointment.preferredDate}</p>` : ''}
                                ${appointment.symptoms ? `<p><strong>症狀:</strong> ${appointment.symptoms}</p>` : ''}
                                <p><strong>預約時間:</strong> ${appointment.createdAt?.toDate?.()?.toLocaleString('zh-TW') || '未知'}</p>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            ${appointment.status === 'pending' ? `
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'confirmed')" class="text-green-600 hover:text-green-800 text-sm">確認</button>
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'cancelled')" class="text-red-600 hover:text-red-800 text-sm">取消</button>
                            ` : ''}
                            ${appointment.status === 'confirmed' ? `
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'completed')" class="text-blue-600 hover:text-blue-800 text-sm">完成</button>
                            ` : ''}
                        </div>
                    </div>
                `;
                appointmentsList.appendChild(appointmentItem);
            });
        }

        // 更新預約狀態
        async function updateAppointmentStatus(appointmentId, status) {
            try {
                if (window.FirebaseManager) {
                    const success = await window.FirebaseManager.updateAppointmentStatus(appointmentId, status);
                    if (success) {
                        await loadAppointments(); // 重新載入列表
                    } else {
                        alert('更新預約狀態失敗');
                    }
                }
            } catch (error) {
                console.error('更新預約狀態失敗:', error);
                alert('更新預約狀態時發生錯誤');
            }
        }

        // 保存設置
        async function saveSettings() {
            const saveLoading = document.getElementById('save-loading');
            saveLoading.classList.remove('hidden');
            
            try {
                const settings = {
                    clinicName: document.getElementById('clinic-name').value,
                    clinicAddress: document.getElementById('clinic-address').value,
                    clinicPhone: document.getElementById('clinic-phone').value
                };

                // 保存到 Firebase
                if (window.FirebaseManager) {
                    const success = await window.FirebaseManager.saveSettings(settings);
                    if (success) {
                        // 應用設置到頁面
                        applySettings(settings);
                        alert('設置已保存到 Firebase！');
                    } else {
                        throw new Error('保存到 Firebase 失敗');
                    }
                } else {
                    throw new Error('Firebase 未連接');
                }
            } catch (error) {
                console.error('保存設置失敗:', error);
                alert('保存設置時發生錯誤：' + error.message);
            } finally {
                saveLoading.classList.add('hidden');
            }
        }

        // 重新載入 Firebase 資料
        async function reloadFromFirebase() {
            const syncFromLoading = document.getElementById('sync-from-loading');
            const syncStatus = document.getElementById('sync-status');
            
            syncFromLoading.classList.remove('hidden');
            syncStatus.textContent = '正在從 Firebase 重新載入...';
            
            try {
                if (!window.FirebaseManager) {
                    throw new Error('Firebase 未初始化');
                }

                // 從 Firebase 載入設置
                const firebaseSettings = await window.FirebaseManager.loadSettings();
                
                if (firebaseSettings) {
                    // 應用設置到頁面
                    applySettings(firebaseSettings);
                    
                    // 更新設置面板的值
                    if (document.getElementById('clinic-name')) {
                        document.getElementById('clinic-name').value = firebaseSettings.clinicName;
                        document.getElementById('clinic-address').value = firebaseSettings.clinicAddress;
                        document.getElementById('clinic-phone').value = firebaseSettings.clinicPhone;
                    }
                }

                // 重新載入醫師資料
                const doctors = await window.FirebaseManager.loadDoctors();
                if (doctors.length > 0) {
                    currentDoctors = doctors;
                    renderDoctors();
                }

                // 重新載入最新消息
                const news = await window.FirebaseManager.loadNews();
                if (news.length > 0) {
                    currentNews = news;
                    renderNews();
                }
                
                syncStatus.textContent = '重新載入完成！頁面已更新為最新的 Firebase 資料。';
                syncStatus.className = 'p-4 rounded-lg bg-green-50 text-sm text-green-600';
            } catch (error) {
                console.error('從 Firebase 載入失敗:', error);
                syncStatus.textContent = '載入失敗：' + error.message;
                syncStatus.className = 'p-4 rounded-lg bg-red-50 text-sm text-red-600';
            } finally {
                syncFromLoading.classList.add('hidden');
            }
        }

        // 平滑滾動功能
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // 手機版選單切換
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // 滾動動畫效果
        function handleScrollAnimation() {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.classList.add('visible');
                }
            });
        }

        // 導航欄背景變化
        function handleNavbarScroll() {
            const navbar = document.querySelector('nav');
            if (window.scrollY > 50) {
                navbar.classList.add('shadow-lg');
            } else {
                navbar.classList.remove('shadow-lg');
            }
        }

        // 導航連結點擊處理
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
                
                // 關閉手機版選單
                const mobileMenu = document.getElementById('mobile-menu');
                mobileMenu.classList.add('hidden');
            });
        });

        // 滾動事件監聽
        window.addEventListener('scroll', function() {
            handleScrollAnimation();
            handleNavbarScroll();
        });

        // 頁面載入完成後執行
        window.addEventListener('load', function() {
            handleScrollAnimation();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b5813584220725',t:'MTc1NDU1NjM5OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
