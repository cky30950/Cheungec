<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>仁心中醫診所 - 傳承千年智慧，守護現代健康</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore, doc, getDoc, setDoc, collection, getDocs, addDoc, updateDoc, deleteDoc, query, orderBy } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Firebase 設定
        const firebaseConfig = {
            apiKey: "AIzaSyBx6RQt7wA2DDnxkQiIfh8ubzpzKYfXWGg",
            authDomain: "clinic-bb064.firebaseapp.com",
            databaseURL: "https://clinic-bb064-default-rtdb.firebaseio.com",
            projectId: "clinic-bb064",
            storageBucket: "clinic-bb064.firebasestorage.app",
            messagingSenderId: "387800418575",
            appId: "1:387800418575:web:4dc6baafbedf640ac1567a",
            measurementId: "G-1KW4XQX10N"
        };

        // 初始化 Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // 將 Firebase 實例掛載到 window 物件，供其他腳本使用
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseModules = {
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            doc,
            getDoc,
            setDoc,
            collection,
            getDocs,
            addDoc,
            updateDoc,
            deleteDoc,
            query,
            orderBy
        };

        // 監聽認證狀態變化
        onAuthStateChanged(auth, (user) => {
            if (user) {
                console.log('用戶已登入:', user.email);
                window.currentUser = user;
                updateUIForLoggedInUser();
            } else {
                console.log('用戶已登出');
                window.currentUser = null;
                updateUIForLoggedOutUser();
            }
        });

        // 更新已登入用戶的 UI
        function updateUIForLoggedInUser() {
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (loginBtn && logoutBtn) {
                loginBtn.textContent = '🔐 系統設置';
                logoutBtn.classList.remove('hidden');
                window.isLoggedIn = true;
            }
        }

        // 更新已登出用戶的 UI
        function updateUIForLoggedOutUser() {
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            
            if (loginBtn && logoutBtn) {
                loginBtn.textContent = '🔐 系統設置';
                logoutBtn.classList.add('hidden');
                window.isLoggedIn = false;
            }
        }

        // Firebase 資料庫操作函數
        window.FirebaseManager = {
            // 儲存設置到 Firestore
            async saveSettings(settings) {
                try {
                    await setDoc(doc(db, 'clinic-settings', 'main'), {
                        ...settings,
                        updatedAt: new Date(),
                        updatedBy: auth.currentUser?.email || 'system'
                    });
                    console.log('設置已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存設置失敗:', error);
                    return false;
                }
            },

            // 從 Firestore 載入設置
            async loadSettings() {
                try {
                    const docRef = doc(db, 'clinic-settings', 'main');
                    const docSnap = await getDoc(docRef);
                    
                    if (docSnap.exists()) {
                        console.log('從 Firestore 載入設置');
                        return docSnap.data();
                    } else {
                        console.log('Firestore 中沒有設置，使用預設值');
                        return null;
                    }
                } catch (error) {
                    console.error('載入設置失敗:', error);
                    return null;
                }
            },

            // 儲存最新消息
            async saveNews(newsList) {
                try {
                    const newsCollection = collection(db, 'news');
                    
                    // 先清除舊資料（在實際應用中可能需要更精細的處理）
                    const existingNews = await getDocs(newsCollection);
                    for (const doc of existingNews.docs) {
                        await deleteDoc(doc.ref);
                    }
                    
                    // 新增新資料
                    for (const news of newsList) {
                        await addDoc(newsCollection, {
                            ...news,
                            createdAt: new Date(),
                            updatedAt: new Date()
                        });
                    }
                    
                    console.log('最新消息已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存最新消息失敗:', error);
                    return false;
                }
            },

            // 載入最新消息
            async loadNews() {
                try {
                    const newsCollection = collection(db, 'news');
                    const q = query(newsCollection, orderBy('createdAt', 'desc'));
                    const querySnapshot = await getDocs(q);
                    
                    const newsList = [];
                    querySnapshot.forEach((doc) => {
                        newsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入最新消息');
                    return newsList;
                } catch (error) {
                    console.error('載入最新消息失敗:', error);
                    return [];
                }
            },

            // 儲存醫師資料
            async saveDoctors(doctorsList) {
                try {
                    const doctorsCollection = collection(db, 'doctors');
                    
                    // 清除舊資料
                    const existingDoctors = await getDocs(doctorsCollection);
                    for (const doc of existingDoctors.docs) {
                        await deleteDoc(doc.ref);
                    }
                    
                    // 新增新資料
                    for (const doctor of doctorsList) {
                        await addDoc(doctorsCollection, {
                            ...doctor,
                            createdAt: new Date(),
                            updatedAt: new Date()
                        });
                    }
                    
                    console.log('醫師資料已儲存到 Firestore');
                    return true;
                } catch (error) {
                    console.error('儲存醫師資料失敗:', error);
                    return false;
                }
            },

            // 載入醫師資料
            async loadDoctors() {
                try {
                    const doctorsCollection = collection(db, 'doctors');
                    const querySnapshot = await getDocs(doctorsCollection);
                    
                    const doctorsList = [];
                    querySnapshot.forEach((doc) => {
                        doctorsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入醫師資料');
                    return doctorsList;
                } catch (error) {
                    console.error('載入醫師資料失敗:', error);
                    return [];
                }
            },

            // 儲存預約資料
            async saveAppointment(appointmentData) {
                try {
                    const appointmentsCollection = collection(db, 'appointments');
                    const docRef = await addDoc(appointmentsCollection, {
                        ...appointmentData,
                        status: 'pending', // 待確認
                        createdAt: new Date(),
                        updatedAt: new Date()
                    });
                    
                    console.log('預約資料已儲存，ID:', docRef.id);
                    return docRef.id;
                } catch (error) {
                    console.error('儲存預約資料失敗:', error);
                    return null;
                }
            },

            // 載入預約資料
            async loadAppointments() {
                try {
                    const appointmentsCollection = collection(db, 'appointments');
                    const q = query(appointmentsCollection, orderBy('createdAt', 'desc'));
                    const querySnapshot = await getDocs(q);
                    
                    const appointmentsList = [];
                    querySnapshot.forEach((doc) => {
                        appointmentsList.push({ id: doc.id, ...doc.data() });
                    });
                    
                    console.log('從 Firestore 載入預約資料');
                    return appointmentsList;
                } catch (error) {
                    console.error('載入預約資料失敗:', error);
                    return [];
                }
            },

            // 更新預約狀態
            async updateAppointmentStatus(appointmentId, status) {
                try {
                    const appointmentRef = doc(db, 'appointments', appointmentId);
                    await updateDoc(appointmentRef, {
                        status: status,
                        updatedAt: new Date()
                    });
                    
                    console.log('預約狀態已更新');
                    return true;
                } catch (error) {
                    console.error('更新預約狀態失敗:', error);
                    return false;
                }
            }
        };
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Noto Sans TC', sans-serif;
        }
        
        .hero-gradient {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%);
        }
        
        .card-hover {
            transition: all 0.3s ease;
        }
        
        .card-hover:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease;
        }
        
        .fade-in.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .nav-link {
            position: relative;
            transition: color 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: -5px;
            left: 50%;
            background-color: #3b82f6;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
            left: 0;
        }
        
        .floating-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .testimonial-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- 導航欄 -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="text-2xl font-bold text-blue-600">🏥 仁心中醫診所</div>
                </div>
                <div class="hidden md:flex md:items-center md:space-x-8">
                    <a href="#home" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">首頁</a>
                    <a href="#posters" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">宣傳畫報</a>
                    <a href="#about" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">關於我們</a>
                    <a href="#services" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">診療項目</a>
                    <a href="#doctors" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">醫師團隊</a>
                    <a href="#gallery" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">診所環境</a>
                    <a href="#news" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">最新消息</a>
                    <a href="#contact" class="nav-link text-gray-700 hover:text-blue-600 px-3 py-2 text-sm font-medium">聯絡我們</a>
                    <div class="relative">
                        <button id="admin-menu-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition duration-300 flex items-center">
                            ⚙️ 管理
                            <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="admin-dropdown" class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border hidden z-50">
                            <a id="backend-link" href="#" target="_blank" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center">
                                🖥️ 後台管理
                                <svg class="w-3 h-3 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                                </svg>
                            </a>
                            <button id="login-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100">
                                🔐 系統設置
                            </button>
                            <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-b-lg hidden">
                                🚪 登出
                            </button>
                        </div>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-btn" class="text-gray-700 hover:text-blue-600">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- 手機版選單 -->
        <div id="mobile-menu" class="md:hidden hidden bg-white border-t">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#home" class="block px-3 py-2 text-gray-700 hover:text-blue-600">首頁</a>
                <a href="#posters" class="block px-3 py-2 text-gray-700 hover:text-blue-600">宣傳畫報</a>
                <a href="#about" class="block px-3 py-2 text-gray-700 hover:text-blue-600">關於我們</a>
                <a href="#services" class="block px-3 py-2 text-gray-700 hover:text-blue-600">診療項目</a>
                <a href="#doctors" class="block px-3 py-2 text-gray-700 hover:text-blue-600">醫師團隊</a>
                <a href="#gallery" class="block px-3 py-2 text-gray-700 hover:text-blue-600">診所環境</a>
                <a href="#news" class="block px-3 py-2 text-gray-700 hover:text-blue-600">最新消息</a>
                <a href="#contact" class="block px-3 py-2 text-gray-700 hover:text-blue-600">聯絡我們</a>
                <button id="mobile-admin-btn" class="block w-full text-left px-3 py-2 text-blue-600 hover:text-blue-800 font-medium">
                    ⚙️ 系統管理
                </button>
            </div>
        </div>
    </nav>

    <!-- 主視覺區 -->
    <section id="home" class="hero-gradient text-white pt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="fade-in">
                    <h1 class="text-4xl md:text-6xl font-bold mb-6">
                        傳承千年智慧<br>
                        <span class="text-cyan-300">守護現代健康</span>
                    </h1>
                    <p class="text-xl mb-8 text-blue-100">
                        結合傳統中醫精髓與現代醫學技術，為您提供全方位的健康照護服務。
                        專業醫師團隊，用心呵護每一位患者的健康。
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <button onclick="scrollToSection('contact')" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition duration-300">
                            立即預約
                        </button>
                        <button onclick="scrollToSection('services')" class="border-2 border-white text-white px-8 py-3 rounded-lg font-semibold hover:bg-white hover:text-blue-600 transition duration-300">
                            了解更多
                        </button>
                    </div>
                </div>
                <div class="fade-in">
                    <div class="bg-white/10 backdrop-blur-sm rounded-2xl p-8">
                        <h3 class="text-2xl font-bold mb-6 text-center">診所資訊</h3>
                        <div class="space-y-4">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">📍</span>
                                <span>台北市中正區健康路123號</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">📞</span>
                                <span>(02) 2345-6789</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">🕒</span>
                                <span>週一至週六 09:00-21:00</span>
                            </div>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">🚇</span>
                                <span>捷運中正紀念堂站 2號出口</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 宣傳畫報 -->
    <section id="posters" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">健康宣傳畫報</h2>
                <p class="text-xl text-gray-600">
                    分享中醫養生知識，傳播健康生活理念
                </p>
            </div>

            <!-- 宣傳畫報輪播 -->
            <div class="relative">
                <div id="posters-carousel" class="overflow-hidden rounded-2xl">
                    <div id="posters-slides" class="flex transition-transform duration-500 ease-in-out">
                        <!-- 畫報幻燈片將由 JavaScript 動態生成 -->
                    </div>
                </div>
                
                <!-- 輪播控制按鈕 -->
                <button id="posters-prev" class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="posters-next" class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
                
                <!-- 輪播指示器 -->
                <div id="posters-indicators" class="flex justify-center mt-6 space-x-2">
                    <!-- 指示器將由 JavaScript 動態生成 -->
                </div>
            </div>
        </div>
    </section>

    <!-- 關於我們 -->
    <section id="about" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">關於仁心中醫診所</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto">
                    秉承「仁心仁術，濟世救人」的理念，我們致力於傳承中醫文化，結合現代醫學技術，為患者提供最優質的醫療服務。
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div class="fade-in">
                    <div class="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-2xl p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">我們的使命</h3>
                        <div class="space-y-4">
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🎯</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">專業醫療</h4>
                                    <p class="text-gray-600">提供專業、安全、有效的中醫診療服務</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">❤️</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">用心關懷</h4>
                                    <p class="text-gray-600">以患者為中心，提供溫馨貼心的醫療體驗</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🌱</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-2">持續創新</h4>
                                    <p class="text-gray-600">結合傳統智慧與現代科技，不斷提升醫療品質</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="fade-in">
                    <div class="space-y-6">
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🏆</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">專業認證</h4>
                            <p class="text-gray-600">所有醫師均具備國家中醫師執照，並持續接受專業培訓</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🌿</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">天然療法</h4>
                            <p class="text-gray-600">採用純天然中藥材，安全無副作用的治療方式</p>
                        </div>
                        
                        <div class="bg-white rounded-xl shadow-lg p-6 card-hover">
                            <div class="text-3xl mb-4">🤝</div>
                            <h4 class="text-xl font-bold text-gray-900 mb-2">個人化治療</h4>
                            <p class="text-gray-600">根據每位患者的體質和症狀，制定專屬治療方案</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 診療項目 -->
    <section id="services" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">診療項目</h2>
                <p class="text-xl text-gray-600">
                    提供全方位的中醫診療服務，守護您的健康
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🩺</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">內科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 感冒咳嗽、過敏性鼻炎</li>
                        <li>• 胃腸疾病、消化不良</li>
                        <li>• 失眠、焦慮、憂鬱</li>
                        <li>• 高血壓、糖尿病調理</li>
                        <li>• 慢性疲勞症候群</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🦴</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">骨傷科</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 頸肩腰腿痛</li>
                        <li>• 關節炎、風濕痛</li>
                        <li>• 運動傷害復健</li>
                        <li>• 椎間盤突出</li>
                        <li>• 骨質疏鬆調理</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">👩‍⚕️</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">婦科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 月經不調、痛經</li>
                        <li>• 更年期症候群</li>
                        <li>• 不孕症調理</li>
                        <li>• 產後調理</li>
                        <li>• 子宮肌瘤、卵巢囊腫</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">👶</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">兒科調理</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 小兒感冒、發燒</li>
                        <li>• 過敏性疾病</li>
                        <li>• 消化不良、厭食</li>
                        <li>• 生長發育調理</li>
                        <li>• 注意力不集中</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">🌸</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">美容養生</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 美容針灸</li>
                        <li>• 減重瘦身</li>
                        <li>• 皮膚問題調理</li>
                        <li>• 抗衰老保養</li>
                        <li>• 體質調理</li>
                    </ul>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="text-4xl mb-4 text-center">⚡</div>
                    <h3 class="text-xl font-bold text-gray-900 mb-4 text-center">特色療法</h3>
                    <ul class="text-gray-600 space-y-2">
                        <li>• 針灸治療</li>
                        <li>• 推拿按摩</li>
                        <li>• 拔罐刮痧</li>
                        <li>• 艾灸療法</li>
                        <li>• 中藥薰蒸</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- 醫師團隊 -->
    <section id="doctors" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">專業醫師團隊</h2>
                <p class="text-xl text-gray-600">
                    經驗豐富的中醫師，為您提供專業的醫療服務
                </p>
            </div>

            <div id="doctors-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- 醫師卡片將由 JavaScript 動態生成 -->
            </div>
        </div>
    </section>

    <!-- 診所環境 -->
    <section id="gallery" class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">診所環境</h2>
                <p class="text-xl text-gray-600">
                    舒適溫馨的就診環境，讓您感受到家的溫暖
                </p>
            </div>

            <!-- 診所環境輪播 -->
            <div class="relative">
                <div id="gallery-carousel" class="overflow-hidden rounded-2xl">
                    <div id="gallery-slides" class="flex transition-transform duration-500 ease-in-out">
                        <!-- 環境圖片將由 JavaScript 動態生成 -->
                    </div>
                </div>
                
                <!-- 輪播控制按鈕 -->
                <button id="gallery-prev" class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                </button>
                <button id="gallery-next" class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white text-gray-800 p-3 rounded-full shadow-lg transition duration-300">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </button>
                
                <!-- 縮圖導航 -->
                <div id="gallery-thumbnails" class="flex justify-center mt-6 space-x-4 overflow-x-auto pb-2">
                    <!-- 縮圖將由 JavaScript 動態生成 -->
                </div>
            </div>
        </div>
    </section>



    <!-- 最新消息 -->
    <section id="news" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">最新消息</h2>
            </div>

            <div id="news-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- 最新消息將由 JavaScript 動態生成 -->
            </div>
        </div>
    </section>

    <!-- 患者見證 -->
    <section class="py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">患者見證</h2>
                <p class="text-xl text-gray-600">
                    真實的治療經驗分享
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-blue-600 font-bold">王</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">王小姐</h4>
                            <p class="text-gray-600 text-sm">上班族</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "長期的肩須痠痛困擾我很久，經過王醫師的針灸治療和中藥調理，現在症狀明顯改善了。醫師很專業，護理人員也很親切！"
                    </p>
                </div>

                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-green-600 font-bold">李</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">李先生</h4>
                            <p class="text-gray-600 text-sm">退休人員</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "糖尿病的血糖控制一直不理想，在這裡接受中醫調理後，血糖穩定了很多，整個人的精神狀態也變好了。"
                    </p>
                </div>

                <div class="testimonial-card rounded-xl shadow-lg p-8 card-hover fade-in">
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mr-4">
                            <span class="text-purple-600 font-bold">陳</span>
                        </div>
                        <div>
                            <h4 class="font-bold text-gray-900">陳太太</h4>
                            <p class="text-gray-600 text-sm">家庭主婦</p>
                        </div>
                    </div>
                    <div class="text-yellow-400 mb-4">⭐⭐⭐⭐⭐</div>
                    <p class="text-gray-700 italic">
                        "更年期的各種不適症狀讓我很困擾，李醫師的治療讓我重新找回了生活品質。診所環境很舒適，服務也很周到。"
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- 聯絡我們 -->
    <section id="contact" class="py-20 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-900 mb-4">聯絡我們</h2>
                <p class="text-xl text-gray-600">
                    歡迎預約諮詢，我們將竭誠為您服務
                </p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- 聯絡資訊 -->
                <div class="fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">診所資訊</h3>
                        
                        <div class="space-y-6">
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📍</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">地址</h4>
                                    <p class="text-gray-600">台北市中正區健康路123號1-3樓</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📞</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">電話</h4>
                                    <p class="text-gray-600">(02) 2345-6789</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">📧</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">電子信箱</h4>
                                    <p class="text-gray-600">info@renxin-tcm.com.tw</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🕒</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">門診時間</h4>
                                    <div class="text-gray-600 space-y-1">
                                        <p>週一至週五：09:00-12:00, 14:00-17:00, 18:00-21:00</p>
                                        <p>週六：09:00-12:00, 14:00-17:00</p>
                                        <p>週日：休診</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="text-2xl mr-4">🚇</div>
                                <div>
                                    <h4 class="font-semibold text-gray-900 mb-1">交通資訊</h4>
                                    <div class="text-gray-600 space-y-1">
                                        <p>捷運：中正紀念堂站2號出口，步行3分鐘</p>
                                        <p>公車：15, 18, 236, 295路線</p>
                                        <p>停車：診所附近有多個付費停車場</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 預約表單 -->
                <div class="fade-in">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <h3 class="text-2xl font-bold text-gray-900 mb-6">線上預約</h3>
                        
                        <form id="appointment-form" class="space-y-6">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">姓名 *</label>
                                    <input type="text" id="patient-name" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入您的姓名">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">電話 *</label>
                                    <input type="tel" id="patient-phone" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入聯絡電話">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">電子信箱</label>
                                <input type="email" id="patient-email" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請輸入電子信箱">
                            </div>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">希望預約醫師</label>
                                    <select id="preferred-doctor" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <option value="">請選擇醫師</option>
                                        <option value="王志明">王志明 院長</option>
                                        <option value="李美華">李美華 醫師</option>
                                        <option value="陳建宏">陳建宏 醫師</option>
                                        <option value="張雅芳">張雅芳 醫師</option>
                                        <option value="林志強">林志強 醫師</option>
                                        <option value="黃淑惠">黃淑惠 醫師</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">希望預約日期</label>
                                    <input type="date" id="preferred-date" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                </div>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">症狀描述</label>
                                <textarea id="symptoms" rows="4" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="請簡述您的症狀或需求"></textarea>
                            </div>
                            
                            <button type="submit" id="submit-appointment" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                                <span id="submit-text">提交預約申請</span>
                                <div id="submit-loading" class="loading ml-2 hidden"></div>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- 頁尾 -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <div class="text-2xl font-bold mb-4">🏥 仁心中醫診所</div>
                    <p class="text-gray-400 mb-4">傳承千年智慧，守護現代健康</p>
                    <div class="flex space-x-4">
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">📘</a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">📷</a>
                        <a href="#" class="text-gray-400 hover:text-white transition duration-300">🐦</a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">快速連結</h3>
                    <ul class="space-y-2">
                        <li><a href="#posters" class="text-gray-400 hover:text-white transition duration-300">宣傳畫報</a></li>
                        <li><a href="#about" class="text-gray-400 hover:text-white transition duration-300">關於我們</a></li>
                        <li><a href="#services" class="text-gray-400 hover:text-white transition duration-300">診療項目</a></li>
                        <li><a href="#doctors" class="text-gray-400 hover:text-white transition duration-300">醫師團隊</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">診療項目</h3>
                    <ul class="space-y-2">
                        <li><span class="text-gray-400">內科調理</span></li>
                        <li><span class="text-gray-400">骨傷科</span></li>
                        <li><span class="text-gray-400">婦科調理</span></li>
                        <li><span class="text-gray-400">兒科調理</span></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">聯絡資訊</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li>📍 台北市中正區健康路123號</li>
                        <li>📞 (02) 2345-6789</li>
                        <li>📧 info@renxin-tcm.com.tw</li>
                        <li>🕒 週一至週六 09:00-21:00</li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-800 mt-8 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-400 mb-4 md:mb-0">© 2024 仁心中醫診所. All rights reserved.</p>
                    <div class="flex space-x-6 text-sm">
                        <button id="privacy-link" class="text-gray-400 hover:text-white transition duration-300">隱私政策</button>
                        <button id="terms-link" class="text-gray-400 hover:text-white transition duration-300">服務條款</button>
                        <button id="disclaimer-link" class="text-gray-400 hover:text-white transition duration-300">免責聲明</button>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- 浮動預約按鈕 -->
    <button onclick="scrollToSection('contact')" class="floating-btn bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition duration-300">
        📞 立即預約
    </button>

    <!-- 法律條款彈出視窗 -->
    <div id="legal-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center">
                    <h2 id="legal-modal-title" class="text-2xl font-bold text-gray-900">法律條款</h2>
                    <button id="close-legal-modal" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <div id="legal-modal-content" class="prose max-w-none">
                        <!-- 法律條款內容將動態載入 -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 登入對話框 -->
    <div id="login-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-md w-full">
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-2xl font-bold text-gray-900">管理員登入</h2>
                        <button id="close-login" class="text-gray-500 hover:text-gray-700">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </div>
                    
                    <form id="login-form" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">電子信箱</label>
                            <input type="email" id="admin-email" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入管理員信箱">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">密碼</label>
                            <input type="password" id="admin-password" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入密碼">
                        </div>
                        
                        <div id="login-error" class="text-red-600 text-sm hidden">登入失敗，請檢查帳號密碼</div>
                        
                        <button type="submit" id="login-submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                            <span id="login-text">登入</span>
                            <div id="login-loading" class="loading ml-2 hidden"></div>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 醫師編輯對話框 -->
    <div id="doctor-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center">
                    <h2 id="doctor-modal-title" class="text-2xl font-bold text-gray-900">編輯醫師資料</h2>
                    <button id="close-doctor-modal" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <form id="doctor-form" class="space-y-6">
                        <!-- 醫師照片上傳區 -->
                        <div class="text-center">
                            <div class="mb-4">
                                <div id="doctor-photo-preview" class="w-32 h-32 mx-auto rounded-full overflow-hidden border-4 border-gray-200 bg-gray-100 flex items-center justify-center">
                                    <span id="doctor-photo-placeholder" class="text-4xl font-bold text-gray-400">👤</span>
                                    <img id="doctor-photo-img" class="w-full h-full object-cover hidden" alt="醫師照片">
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">醫師照片</label>
                                    <div class="flex flex-col space-y-2">
                                        <input type="file" id="doctor-photo-file" accept="image/*" class="hidden">
                                        <button type="button" id="upload-photo-btn" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                            📷 選擇照片
                                        </button>
                                        <div class="text-xs text-gray-500">
                                            支援 JPG、PNG 格式，建議尺寸 300x300 像素
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="text-center">
                                    <span class="text-sm text-gray-500">或</span>
                                </div>
                                
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">照片網址</label>
                                    <input type="url" id="doctor-photo-url" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="https://example.com/photo.jpg">
                                    <div class="text-xs text-gray-500 mt-1">
                                        可直接輸入網路圖片網址
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 基本資料 -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">姓名 *</label>
                                <input type="text" id="doctor-name" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">職稱</label>
                                <input type="text" id="doctor-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="主治醫師">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">專長</label>
                            <input type="text" id="doctor-specialty" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="內科、針灸">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">經驗</label>
                            <input type="text" id="doctor-experience" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="20年臨床經驗">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">學歷</label>
                            <input type="text" id="doctor-education" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="中國醫藥大學中醫學系">
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">簡介</label>
                            <textarea id="doctor-description" rows="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入醫師簡介..."></textarea>
                        </div>
                        
                        <div class="flex justify-end space-x-4">
                            <button type="button" id="cancel-doctor" class="px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition duration-300">
                                取消
                            </button>
                            <button type="submit" id="save-doctor" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center">
                                <span id="save-doctor-text">保存</span>
                                <div id="save-doctor-loading" class="loading ml-2 hidden"></div>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 系統設置面板 -->
    <div id="settings-panel" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-y-auto">
                <div class="sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center">
                    <h2 class="text-2xl font-bold text-gray-900">系統設置</h2>
                    <button id="close-settings" class="text-gray-500 hover:text-gray-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div class="p-6">
                    <!-- 設置分頁 -->
                    <div class="border-b mb-6">
                        <nav class="flex flex-wrap gap-4">
                            <button class="settings-tab active py-2 px-1 border-b-2 border-blue-600 text-blue-600 font-medium" data-tab="basic">基本設置</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="content">內容編輯</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="doctors">醫師管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="news">消息管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="appointments">預約管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="style">樣式設置</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="testimonials">見證管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="gallery">環境管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="posters">畫報管理</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="sync">資料同步</button>
                            <button class="settings-tab py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700" data-tab="legal">法律條款</button>
                        </nav>
                    </div>

                    <!-- 基本設置分頁 -->
                    <div id="basic-tab" class="settings-content">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">基本設置</h3>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">診所名稱</label>
                                <input type="text" id="clinic-name" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="仁心中醫診所">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">診所地址</label>
                                <input type="text" id="clinic-address" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="台北市中正區健康路123號">
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">聯絡電話</label>
                                <input type="text" id="clinic-phone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="(02) 2345-6789">
                            </div>
                        </div>
                    </div>

                    <!-- 內容編輯分頁 -->
                    <div id="content-tab" class="settings-content hidden">
                        <div class="space-y-8">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">網頁內容編輯</h3>
                            
                            <!-- 主視覺區編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🏠 主視覺區</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">主標題</label>
                                        <input type="text" id="hero-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="傳承千年智慧">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">副標題</label>
                                        <input type="text" id="hero-subtitle" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="守護現代健康">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="hero-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">結合傳統中醫精髓與現代醫學技術，為您提供全方位的健康照護服務。專業醫師團隊，用心呵護每一位患者的健康。</textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">第一個按鈕文字</label>
                                        <input type="text" id="hero-btn1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="立即預約">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">第二個按鈕文字</label>
                                        <input type="text" id="hero-btn2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="了解更多">
                                    </div>
                                </div>
                            </div>

                            <!-- 關於我們編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">ℹ️ 關於我們</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="about-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="關於仁心中醫診所">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="about-description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">秉承「仁心仁術，濟世救人」的理念，我們致力於傳承中醫文化，結合現代醫學技術，為患者提供最優質的醫療服務。</textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">使命標題</label>
                                        <input type="text" id="mission-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="我們的使命">
                                    </div>
                                </div>
                            </div>

                            <!-- 診療項目編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🩺 診療項目</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="services-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="診療項目">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="services-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">提供全方位的中醫診療服務，守護您的健康</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 醫師團隊編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">👨‍⚕️ 醫師團隊</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="doctors-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="專業醫師團隊">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="doctors-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">經驗豐富的中醫師，為您提供專業的醫療服務</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 診所環境編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🏥 診所環境</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="gallery-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="診所環境">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="gallery-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">舒適溫馨的就診環境，讓您感受到家的溫暖</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 宣傳畫報編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">📋 宣傳畫報</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="posters-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="健康宣傳畫報">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="posters-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">分享中醫養生知識，傳播健康生活理念</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 最新消息編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">📰 最新消息</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="news-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="最新消息">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="news-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">掌握診所最新動態與健康資訊</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 患者見證編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">💬 患者見證</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="testimonials-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="患者見證">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="testimonials-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">真實的治療經驗分享</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 聯絡我們編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">📞 聯絡我們</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題</label>
                                        <input type="text" id="contact-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="聯絡我們">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">描述文字</label>
                                        <textarea id="contact-description" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">歡迎預約諮詢，我們將竭誠為您服務</textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">電子信箱</label>
                                        <input type="email" id="clinic-email" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="info@renxin-tcm.com.tw">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">門診時間</label>
                                        <textarea id="clinic-hours" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">週一至週五：09:00-12:00, 14:00-17:00, 18:00-21:00
週六：09:00-12:00, 14:00-17:00
週日：休診</textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">交通資訊</label>
                                        <textarea id="clinic-transport" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">捷運：中正紀念堂站2號出口，步行3分鐘
公車：15, 18, 236, 295路線
停車：診所附近有多個付費停車場</textarea>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">線上預約表單標題</label>
                                        <input type="text" id="appointment-form-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="線上預約">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">預約按鈕文字</label>
                                        <input type="text" id="appointment-btn-text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="提交預約申請">
                                    </div>
                                </div>
                            </div>

                            <!-- 頁尾編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🦶 頁尾設置</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">頁尾標語</label>
                                        <input type="text" id="footer-slogan" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="傳承千年智慧，守護現代健康">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">版權聲明</label>
                                        <input type="text" id="footer-copyright" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="© 2024 仁心中醫診所. All rights reserved.">
                                    </div>
                                </div>
                            </div>

                            <!-- 浮動按鈕編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🎈 浮動按鈕</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">浮動按鈕文字</label>
                                        <input type="text" id="floating-btn-text" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="📞 立即預約">
                                    </div>
                                </div>
                            </div>

                            <div class="flex justify-end">
                                <button id="apply-content-changes" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition duration-300 flex items-center">
                                    <span>套用內容變更</span>
                                    <div id="apply-content-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 醫師管理分頁 -->
                    <div id="doctors-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">醫師管理</h3>
                                <button id="add-doctor" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增醫師
                                </button>
                            </div>
                            
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                <div class="flex items-start">
                                    <div class="text-blue-600 mr-3">👨‍⚕️</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800 mb-2">醫師照片上傳說明</h4>
                                        <div class="text-sm text-blue-700 space-y-1">
                                            <p>• 支援兩種上傳方式：本地檔案上傳或網路圖片網址</p>
                                            <p>• 建議照片尺寸：300x300 像素，格式：JPG、PNG</p>
                                            <p>• 檔案大小限制：5MB 以內</p>
                                            <p>• 照片將顯示為圓形頭像，建議使用正方形照片</p>
                                            <p>• 如未上傳照片，將顯示醫師姓名縮寫</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="doctors-management" class="space-y-4">
                                <!-- 醫師管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 消息管理分頁 -->
                    <div id="news-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">消息管理</h3>
                                <button id="add-news" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增消息
                                </button>
                            </div>
                            
                            <div id="news-management" class="space-y-4">
                                <!-- 消息管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 預約管理分頁 -->
                    <div id="appointments-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">預約管理</h3>
                                <button id="refresh-appointments" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center">
                                    <span>重新整理</span>
                                    <div id="refresh-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                            
                            <div id="appointments-list" class="space-y-4">
                                <!-- 預約列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 樣式設置分頁 -->
                    <div id="style-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">樣式設置</h3>
                            
                            <!-- 主題顏色設置 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🎨 主題顏色</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">主要顏色</label>
                                        <input type="color" id="primary-color" class="w-full h-10 border border-gray-300 rounded-lg" value="#2563eb">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">次要顏色</label>
                                        <input type="color" id="secondary-color" class="w-full h-10 border border-gray-300 rounded-lg" value="#06b6d4">
                                    </div>
                                </div>
                            </div>

                            <!-- 字體設置 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">📝 字體設置</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">主標題字體大小</label>
                                        <select id="hero-title-size" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="text-4xl md:text-5xl">中等 (4xl/5xl)</option>
                                            <option value="text-4xl md:text-6xl" selected>大 (4xl/6xl)</option>
                                            <option value="text-5xl md:text-7xl">特大 (5xl/7xl)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">區塊標題字體大小</label>
                                        <select id="section-title-size" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="text-3xl">中等 (3xl)</option>
                                            <option value="text-4xl" selected>大 (4xl)</option>
                                            <option value="text-5xl">特大 (5xl)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 按鈕樣式設置 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🔘 按鈕樣式</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">按鈕圓角</label>
                                        <select id="button-radius" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="rounded">小圓角</option>
                                            <option value="rounded-lg" selected>中圓角</option>
                                            <option value="rounded-xl">大圓角</option>
                                            <option value="rounded-full">完全圓角</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">按鈕大小</label>
                                        <select id="button-size" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="px-6 py-2">小 (px-6 py-2)</option>
                                            <option value="px-8 py-3" selected>中 (px-8 py-3)</option>
                                            <option value="px-10 py-4">大 (px-10 py-4)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- 卡片樣式設置 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🃏 卡片樣式</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">卡片圓角</label>
                                        <select id="card-radius" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="rounded-lg">中圓角</option>
                                            <option value="rounded-xl" selected>大圓角</option>
                                            <option value="rounded-2xl">特大圓角</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">卡片陰影</label>
                                        <select id="card-shadow" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                            <option value="shadow">淺陰影</option>
                                            <option value="shadow-lg" selected>中陰影</option>
                                            <option value="shadow-xl">深陰影</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="flex justify-end">
                                <button id="apply-style-changes" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition duration-300 flex items-center">
                                    <span>套用樣式變更</span>
                                    <div id="apply-style-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- 見證管理分頁 -->
                    <div id="testimonials-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">患者見證管理</h3>
                                <button id="add-testimonial" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增見證
                                </button>
                            </div>
                            
                            <div id="testimonials-management" class="space-y-4">
                                <!-- 見證管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 診所環境管理分頁 -->
                    <div id="gallery-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">診所環境管理</h3>
                                <button id="add-gallery-item" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增環境圖片
                                </button>
                            </div>
                            
                            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                                <div class="flex items-start">
                                    <div class="text-yellow-600 mr-3">💡</div>
                                    <div>
                                        <h4 class="font-semibold text-yellow-800 mb-2">圖片上傳說明</h4>
                                        <div class="text-sm text-yellow-700 space-y-1">
                                            <p>• 目前系統使用圖示和漸層背景來展示診所環境</p>
                                            <p>• 您可以選擇不同的圖示和背景顏色來代表各個區域</p>
                                            <p>• 未來版本將支援實際圖片上傳功能</p>
                                            <p>• 建議圖片尺寸：1200x800 像素，格式：JPG/PNG</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="gallery-management" class="space-y-4">
                                <!-- 環境管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 宣傳畫報管理分頁 -->
                    <div id="posters-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <div class="flex justify-between items-center">
                                <h3 class="text-lg font-semibold text-gray-900">宣傳畫報管理</h3>
                                <button id="add-poster-item" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition duration-300">
                                    新增畫報
                                </button>
                            </div>
                            
                            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                                <div class="flex items-start">
                                    <div class="text-blue-600 mr-3">📋</div>
                                    <div>
                                        <h4 class="font-semibold text-blue-800 mb-2">畫報設計說明</h4>
                                        <div class="text-sm text-blue-700 space-y-1">
                                            <p>• 宣傳畫報用於展示中醫養生知識和健康資訊</p>
                                            <p>• 每個畫報包含標題、副標題、圖示和內容要點</p>
                                            <p>• 可選擇不同的背景顏色和圖示來美化畫報</p>
                                            <p>• 內容要點建議控制在4-6個，每個要點簡潔明瞭</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="posters-management" class="space-y-4">
                                <!-- 畫報管理列表將動態生成 -->
                            </div>
                        </div>
                    </div>

                    <!-- 資料同步分頁 -->
                    <div id="sync-tab" class="settings-content hidden">
                        <div class="space-y-6">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">資料同步</h3>
                            
                            <div class="grid grid-cols-1 gap-4">
                                <button id="sync-from-firebase" class="bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center justify-center">
                                    <span>🔄 重新載入 Firebase 資料</span>
                                    <div id="sync-from-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                            
                            <div id="sync-status" class="p-4 rounded-lg bg-gray-50 text-sm text-gray-600">
                                所有資料都會即時保存到 Firebase。使用上方按鈕可重新載入最新資料。
                            </div>
                        </div>
                    </div>

                    <!-- 法律條款分頁 -->
                    <div id="legal-tab" class="settings-content hidden">
                        <div class="space-y-8">
                            <h3 class="text-lg font-semibold text-gray-900 border-b pb-2">法律條款管理</h3>
                            
                            <!-- 隱私政策編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">🔒 隱私政策</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">隱私政策標題</label>
                                        <input type="text" id="privacy-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="隱私政策">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">隱私政策內容</label>
                                        <textarea id="privacy-content" rows="15" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入隱私政策內容...">仁心中醫診所隱私政策

最後更新日期：2024年3月1日

一、個人資料收集
我們收集的個人資料包括但不限於：
• 姓名、聯絡電話、電子信箱
• 預約資訊、病歷資料
• 健保卡號碼等醫療相關資訊

二、資料使用目的
收集的個人資料僅用於：
• 提供醫療服務
• 預約管理
• 醫療記錄保存
• 法律規定之其他用途

三、資料保護措施
我們採取以下措施保護您的個人資料：
• 資料加密傳輸
• 限制存取權限
• 定期安全檢查
• 員工保密訓練

四、資料分享
除法律規定外，我們不會將您的個人資料分享給第三方。

五、您的權利
您有權：
• 查詢個人資料
• 要求更正錯誤資料
• 要求刪除個人資料
• 撤回同意

六、聯絡我們
如有任何隱私相關問題，請聯絡：
電話：(02) 2345-6789
信箱：privacy@renxin-tcm.com.tw</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 服務條款編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">📋 服務條款</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">服務條款標題</label>
                                        <input type="text" id="terms-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="服務條款">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">服務條款內容</label>
                                        <textarea id="terms-content" rows="15" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入服務條款內容...">仁心中醫診所服務條款

最後更新日期：2024年3月1日

一、服務範圍
本診所提供的服務包括：
• 中醫內科診療
• 針灸治療
• 推拿按摩
• 中藥調劑
• 健康諮詢

二、預約規定
• 請提前24小時預約
• 如需取消或更改，請提前2小時通知
• 無故未到診者，可能影響後續預約權利

三、診療規定
• 請攜帶健保卡及相關證件
• 如實告知病史及用藥情況
• 遵循醫師指示服藥及回診

四、費用說明
• 健保給付項目依健保規定收費
• 自費項目將事先告知費用
• 費用如有調整將提前公告

五、免責聲明
• 治療效果因人而異
• 請遵循醫師指示，如有不適請立即回診
• 本診所不對治療結果做任何保證

六、智慧財產權
本網站所有內容均受智慧財產權保護，未經同意不得轉載。

七、條款修改
本診所保留隨時修改服務條款的權利，修改後將在網站公告。

八、爭議處理
如有爭議，以台灣法律為準據法，台北地方法院為管轄法院。

九、聯絡資訊
如有任何問題，請聯絡：
電話：(02) 2345-6789
地址：台北市中正區健康路123號
信箱：service@renxin-tcm.com.tw</textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- 免責聲明編輯 -->
                            <div class="bg-gray-50 p-6 rounded-lg">
                                <h4 class="text-md font-semibold text-gray-800 mb-4">⚠️ 免責聲明</h4>
                                <div class="space-y-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">免責聲明標題</label>
                                        <input type="text" id="disclaimer-title" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" value="免責聲明">
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">免責聲明內容</label>
                                        <textarea id="disclaimer-content" rows="10" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="請輸入免責聲明內容...">仁心中醫診所免責聲明

一、醫療效果聲明
• 中醫治療效果因個人體質而異
• 本診所不保證任何特定治療效果
• 患者應配合醫師指示進行治療

二、網站資訊聲明
• 網站內容僅供參考，不構成醫療建議
• 如有健康問題，請親自就診諮詢
• 網站資訊可能隨時更新，恕不另行通知

三、第三方連結
• 本網站可能包含第三方網站連結
• 本診所不對第三方網站內容負責
• 使用第三方服務請自行承擔風險

四、技術限制
• 網站可能因技術問題暫時無法使用
• 本診所不對因技術問題造成的損失負責
• 建議重要事項請電話確認

五、個人責任
• 使用本網站服務即表示同意本聲明
• 如不同意請停止使用本網站服務</textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="flex justify-end">
                                <button id="apply-legal-changes" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition duration-300 flex items-center">
                                    <span>套用法律條款變更</span>
                                    <div id="apply-legal-loading" class="loading ml-2 hidden"></div>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 操作按鈕 -->
                    <div class="mt-8 flex justify-between">
                        <button id="save-settings" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition duration-300 flex items-center">
                            <span>保存設置</span>
                            <div id="save-loading" class="loading ml-2 hidden"></div>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 全域變數
        let currentDoctors = [];
        let currentNews = [];
        let currentTestimonials = [];
        let currentGalleryIndex = 0;
        let currentPostersIndex = 0;
        let galleryImages = [];
        let postersData = [];

        // 等待 Firebase 初始化完成
        window.addEventListener('load', async () => {
            // 初始化應用
            await initializeApp();
        });

        // 應用初始化
        async function initializeApp() {
            console.log('初始化應用...');
            
            // 從 Firebase 載入設置
            if (window.FirebaseManager) {
                try {
                    const firebaseSettings = await window.FirebaseManager.loadSettings();
                    if (firebaseSettings) {
                        console.log('從 Firebase 載入設置');
                        applySettings(firebaseSettings);
                    } else {
                        console.log('Firebase 中沒有設置，使用預設值');
                        const defaultSettings = getDefaultSettings();
                        applySettings(defaultSettings);
                        // 將預設設置保存到 Firebase
                        await window.FirebaseManager.saveSettings(defaultSettings);
                    }

                    // 載入醫師資料
                    const doctors = await window.FirebaseManager.loadDoctors();
                    if (doctors.length > 0) {
                        currentDoctors = doctors;
                    } else {
                        currentDoctors = getDefaultDoctors();
                        await window.FirebaseManager.saveDoctors(currentDoctors);
                    }
                    renderDoctors();

                    // 載入最新消息
                    const news = await window.FirebaseManager.loadNews();
                    if (news.length > 0) {
                        currentNews = news;
                    } else {
                        currentNews = getDefaultNews();
                        await window.FirebaseManager.saveNews(currentNews);
                    }
                    renderNews();

                    // 載入診所環境和宣傳畫報資料
                    if (firebaseSettings.galleryImages) {
                        galleryImages = firebaseSettings.galleryImages;
                    } else {
                        galleryImages = getDefaultGalleryImages();
                    }
                    
                    if (firebaseSettings.postersData) {
                        postersData = firebaseSettings.postersData;
                    } else {
                        postersData = getDefaultPostersData();
                    }
                    
                    renderGallery();
                    renderPosters();

                } catch (error) {
                    console.error('載入 Firebase 設置失敗，使用預設設置:', error);
                    const defaultSettings = getDefaultSettings();
                    applySettings(defaultSettings);
                    currentDoctors = getDefaultDoctors();
                    currentNews = getDefaultNews();
                    galleryImages = getDefaultGalleryImages();
                    postersData = getDefaultPostersData();
                    renderDoctors();
                    renderNews();
                    renderGallery();
                    renderPosters();
                }
            } else {
                // Firebase 未初始化時使用預設設置
                const defaultSettings = getDefaultSettings();
                applySettings(defaultSettings);
                currentDoctors = getDefaultDoctors();
                currentNews = getDefaultNews();
                galleryImages = getDefaultGalleryImages();
                postersData = getDefaultPostersData();
                renderDoctors();
                renderNews();
                renderGallery();
                renderPosters();
            }

            // 初始化事件監聽器
            initializeEventListeners();
        }

        // 預設設置
        function getDefaultSettings() {
            return {
                clinicName: '仁心中醫診所',
                clinicAddress: '台北市中正區健康路123號',
                clinicPhone: '(02) 2345-6789',
                clinicEmail: 'info@renxin-tcm.com.tw'
            };
        }

        // 預設醫師資料
        function getDefaultDoctors() {
            return [
                {
                    name: '王志明',
                    title: '院長',
                    specialty: '內科、針灸',
                    experience: '30年臨床經驗',
                    education: '中國醫藥大學中醫學系',
                    description: '專精於內科疾病治療，擅長運用針灸療法治療各種慢性疾病。',
                    photo: 'https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=300&h=300&fit=crop&crop=face'
                },
                {
                    name: '李美華',
                    title: '主治醫師',
                    specialty: '婦科、兒科',
                    experience: '25年臨床經驗',
                    education: '長庚大學中醫學系',
                    description: '專門治療婦科疾病及小兒科疾病，深受患者信賴。',
                    photo: 'https://images.unsplash.com/photo-1594824475317-d0444e6e4b6b?w=300&h=300&fit=crop&crop=face'
                },
                {
                    name: '陳建宏',
                    title: '主治醫師',
                    specialty: '骨傷科、推拿',
                    experience: '20年臨床經驗',
                    education: '義守大學中醫學系',
                    description: '專精於骨傷科治療，結合推拿手法，療效顯著。',
                    photo: 'https://images.unsplash.com/photo-1582750433449-648ed127bb54?w=300&h=300&fit=crop&crop=face'
                },
                {
                    name: '張雅芳',
                    title: '主治醫師',
                    specialty: '皮膚科、美容',
                    experience: '15年臨床經驗',
                    education: '慈濟大學中醫學系',
                    description: '專門治療皮膚疾病，並提供中醫美容調理服務。',
                    photo: 'https://images.unsplash.com/photo-1559839734-2b71ea197ec2?w=300&h=300&fit=crop&crop=face'
                },
                {
                    name: '林志強',
                    title: '主治醫師',
                    specialty: '腫瘤科、免疫',
                    experience: '18年臨床經驗',
                    education: '中山醫學大學中醫學系',
                    description: '專精於腫瘤輔助治療及免疫系統調理。',
                    photo: 'https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=300&h=300&fit=crop&crop=face'
                },
                {
                    name: '黃淑惠',
                    title: '主治醫師',
                    specialty: '精神科、睡眠',
                    experience: '12年臨床經驗',
                    education: '台北醫學大學中醫學系',
                    description: '專門治療失眠、焦慮等精神相關疾病。',
                    photo: 'https://images.unsplash.com/photo-1594824475317-d0444e6e4b6b?w=300&h=300&fit=crop&crop=face'
                }
            ];
        }

        // 預設最新消息
        function getDefaultNews() {
            return [
                {
                    title: '春季養生講座',
                    date: '2024-03-15',
                    category: '活動公告',
                    content: '本診所將於3月20日舉辦春季養生講座，歡迎民眾踴躍參加。',
                    important: true
                },
                {
                    title: '新增夜間門診',
                    date: '2024-03-10',
                    category: '門診異動',
                    content: '為服務更多患者，本診所新增週一至週五夜間門診時段。',
                    important: false
                },
                {
                    title: '中秋節門診調整',
                    date: '2024-03-05',
                    category: '門診異動',
                    content: '中秋節連假期間門診時間調整，請患者注意。',
                    important: false
                },
                {
                    title: '健保卡更新提醒',
                    date: '2024-03-01',
                    category: '重要通知',
                    content: '請患者記得攜帶最新的健保卡就診。',
                    important: true
                }
            ];
        }

        // 預設患者見證
        function getDefaultTestimonials() {
            return [
                {
                    name: '王小姐',
                    title: '上班族',
                    rating: 5,
                    content: '長期的肩須痠痛困擾我很久，經過王醫師的針灸治療和中藥調理，現在症狀明顯改善了。醫師很專業，護理人員也很親切！',
                    initial: '王'
                },
                {
                    name: '李先生',
                    title: '退休人員',
                    rating: 5,
                    content: '糖尿病的血糖控制一直不理想，在這裡接受中醫調理後，血糖穩定了很多，整個人的精神狀態也變好了。',
                    initial: '李'
                },
                {
                    name: '陳太太',
                    title: '家庭主婦',
                    rating: 5,
                    content: '更年期的各種不適症狀讓我很困擾，李醫師的治療讓我重新找回了生活品質。診所環境很舒適，服務也很周到。',
                    initial: '陳'
                }
            ];
        }

        // 預設診所環境圖片
        function getDefaultGalleryImages() {
            return [
                {
                    title: '診所外觀',
                    description: '現代化外觀設計，簡約現代的建築風格，營造專業醫療形象',
                    icon: '🏥',
                    bgColor: 'from-blue-100 to-blue-200'
                },
                {
                    title: '候診區',
                    description: '舒適候診空間，寬敞明亮的候診區，提供舒適的等候環境',
                    icon: '🛋️',
                    bgColor: 'from-green-100 to-green-200'
                },
                {
                    title: '診療室',
                    description: '專業診療空間，配備完善的診療設備，確保診療品質',
                    icon: '🏠',
                    bgColor: 'from-purple-100 to-purple-200'
                },
                {
                    title: '藥房',
                    description: '現代化藥房，嚴格品管的中藥材，確保用藥安全',
                    icon: '💊',
                    bgColor: 'from-yellow-100 to-yellow-200'
                },
                {
                    title: '治療室',
                    description: '特色治療空間，針灸、推拿等特色療法的專用空間',
                    icon: '🌿',
                    bgColor: 'from-red-100 to-red-200'
                },
                {
                    title: '休息區',
                    description: '靜心休息空間，治療後的休息區域，讓身心得到充分放鬆',
                    icon: '🧘',
                    bgColor: 'from-indigo-100 to-indigo-200'
                }
            ];
        }

        // 預設宣傳畫報資料
        function getDefaultPostersData() {
            return [
                {
                    title: '春季養生',
                    subtitle: '春季養肝正當時',
                    icon: '🍃',
                    bgColor: 'from-blue-50 to-blue-100',
                    content: [
                        '早睡早起，順應自然',
                        '多食綠色蔬菜',
                        '適度運動，舒展筋骨',
                        '保持心情愉悅'
                    ]
                },
                {
                    title: '夏季養心',
                    subtitle: '夏季養心防暑熱',
                    icon: '☀️',
                    bgColor: 'from-red-50 to-red-100',
                    content: [
                        '清淡飲食，多喝水',
                        '避免過度勞累',
                        '午休片刻養精神',
                        '心靜自然涼'
                    ]
                },
                {
                    title: '秋季養肺',
                    subtitle: '秋季養肺潤燥氣',
                    icon: '🍂',
                    bgColor: 'from-yellow-50 to-yellow-100',
                    content: [
                        '多食白色食物',
                        '保持室內濕度',
                        '深呼吸練習',
                        '預防感冒'
                    ]
                },
                {
                    title: '冬季養腎',
                    subtitle: '冬季養腎藏精氣',
                    icon: '❄️',
                    bgColor: 'from-gray-50 to-gray-100',
                    content: [
                        '早睡晚起，保存陽氣',
                        '溫補食物為主',
                        '適度運動，不宜過激',
                        '保暖防寒'
                    ]
                },
                {
                    title: '穴位按摩',
                    subtitle: '日常保健穴位',
                    icon: '🧘‍♀️',
                    bgColor: 'from-green-50 to-green-100',
                    content: [
                        '足三里：強身健體',
                        '合谷穴：緩解頭痛',
                        '太衝穴：疏肝理氣',
                        '湧泉穴：補腎益精'
                    ]
                },
                {
                    title: '養生茶飲',
                    subtitle: '四季養生茶推薦',
                    icon: '🍵',
                    bgColor: 'from-purple-50 to-purple-100',
                    content: [
                        '春：玫瑰花茶疏肝',
                        '夏：綠茶清熱解毒',
                        '秋：烏龍茶潤燥',
                        '冬：紅茶溫陽暖胃'
                    ]
                }
            ];
        }

        // 應用設置到頁面
        function applySettings(settings) {
            // 更新診所名稱
            document.querySelectorAll('.text-2xl.font-bold').forEach(el => {
                if (el.textContent.includes('🏥') || el.textContent.includes('仁心中醫診所')) {
                    el.innerHTML = `🏥 ${settings.clinicName}`;
                }
            });

            // 更新聯絡資訊
            document.querySelectorAll('span').forEach(el => {
                if (el.textContent.includes('台北市中正區健康路123號')) {
                    el.textContent = settings.clinicAddress;
                }
                if (el.textContent.includes('(02) 2345-6789')) {
                    el.textContent = settings.clinicPhone;
                }
            });

            // 更新設置面板的值
            if (document.getElementById('clinic-name')) {
                document.getElementById('clinic-name').value = settings.clinicName;
                document.getElementById('clinic-address').value = settings.clinicAddress;
                document.getElementById('clinic-phone').value = settings.clinicPhone;
            }
        }

        // 渲染醫師列表
        function renderDoctors() {
            const container = document.getElementById('doctors-container');
            container.innerHTML = '';

            currentDoctors.forEach((doctor, index) => {
                const doctorCard = document.createElement('div');
                doctorCard.className = 'bg-white rounded-xl shadow-lg p-8 card-hover fade-in';
                
                // 決定顯示照片還是姓名縮寫
                const photoDisplay = doctor.photo ? 
                    `<img src="${doctor.photo}" alt="${doctor.name}" class="w-24 h-24 rounded-full object-cover mx-auto mb-4 border-4 border-blue-100">` :
                    `<div class="w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl font-bold text-blue-600">${doctor.name.charAt(0)}</span>
                    </div>`;
                
                doctorCard.innerHTML = `
                    <div class="text-center mb-6">
                        ${photoDisplay}
                        <h3 class="text-xl font-bold text-gray-900">${doctor.name}</h3>
                        <p class="text-blue-600 font-medium">${doctor.title}</p>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">🎯</span>
                            <span class="text-gray-700">${doctor.specialty}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">📚</span>
                            <span class="text-gray-700">${doctor.experience}</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-blue-600 mr-2">🎓</span>
                            <span class="text-gray-700">${doctor.education}</span>
                        </div>
                    </div>
                    
                    <div class="mt-4 pt-4 border-t">
                        <p class="text-gray-600 text-sm">${doctor.description}</p>
                    </div>
                `;
                
                container.appendChild(doctorCard);
            });
        }

        // 渲染最新消息
        function renderNews() {
            const container = document.getElementById('news-container');
            container.innerHTML = '';

            currentNews.forEach((news, index) => {
                const newsCard = document.createElement('div');
                newsCard.className = 'bg-white rounded-xl shadow-lg p-6 card-hover fade-in';
                
                const importantBadge = news.important ? 
                    '<span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold">重要</span>' : '';
                
                newsCard.innerHTML = `
                    <div class="flex justify-between items-start mb-4">
                        <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-semibold">${news.category}</span>
                        ${importantBadge}
                    </div>
                    
                    <h3 class="text-lg font-bold text-gray-900 mb-2">${news.title}</h3>
                    <p class="text-gray-600 mb-4">${news.content}</p>
                    
                    <div class="flex justify-between items-center text-sm text-gray-500">
                        <span>📅 ${news.date}</span>
                        <button class="text-blue-600 hover:text-blue-800">閱讀更多</button>
                    </div>
                `;
                
                container.appendChild(newsCard);
            });
        }

        // 渲染診所環境
        function renderGallery() {
            const slidesContainer = document.getElementById('gallery-slides');
            const thumbnailsContainer = document.getElementById('gallery-thumbnails');
            
            if (!slidesContainer || !thumbnailsContainer) return;
            
            slidesContainer.innerHTML = '';
            thumbnailsContainer.innerHTML = '';

            galleryImages.forEach((image, index) => {
                // 創建幻燈片
                const slide = document.createElement('div');
                slide.className = 'w-full flex-shrink-0 relative';
                slide.innerHTML = `
                    <div class="aspect-video bg-gradient-to-br ${image.bgColor} rounded-xl overflow-hidden shadow-lg">
                        <div class="h-full flex flex-col items-center justify-center p-8 text-center">
                            <div class="text-6xl mb-4">${image.icon}</div>
                            <h3 class="text-2xl font-bold text-gray-800 mb-2">${image.title}</h3>
                            <p class="text-gray-600 max-w-md">${image.description}</p>
                        </div>
                    </div>
                `;
                slidesContainer.appendChild(slide);

                // 創建縮圖
                const thumbnail = document.createElement('button');
                thumbnail.className = `w-20 h-20 rounded-lg overflow-hidden shadow-md transition duration-300 ${index === currentGalleryIndex ? 'ring-4 ring-blue-500' : 'opacity-70 hover:opacity-100'}`;
                thumbnail.innerHTML = `
                    <div class="w-full h-full bg-gradient-to-br ${image.bgColor} flex items-center justify-center">
                        <span class="text-2xl">${image.icon}</span>
                    </div>
                `;
                thumbnail.addEventListener('click', () => showGallerySlide(index));
                thumbnailsContainer.appendChild(thumbnail);
            });

            // 設置輪播控制
            setupGalleryControls();
        }

        // 渲染宣傳畫報
        function renderPosters() {
            const slidesContainer = document.getElementById('posters-slides');
            const indicatorsContainer = document.getElementById('posters-indicators');
            
            if (!slidesContainer || !indicatorsContainer) return;
            
            slidesContainer.innerHTML = '';
            indicatorsContainer.innerHTML = '';

            postersData.forEach((poster, index) => {
                // 創建畫報幻燈片
                const slide = document.createElement('div');
                slide.className = 'w-full flex-shrink-0 relative';
                slide.innerHTML = `
                    <div class="bg-gradient-to-br ${poster.bgColor} rounded-xl p-8 shadow-lg">
                        <div class="max-w-4xl mx-auto">
                            <div class="text-center mb-8">
                                <div class="text-6xl mb-4">${poster.icon}</div>
                                <h3 class="text-3xl font-bold text-gray-800 mb-2">${poster.title}</h3>
                                <p class="text-xl text-gray-600">${poster.subtitle}</p>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                ${poster.content.map(item => `
                                    <div class="bg-white/80 rounded-lg p-4 shadow-sm">
                                        <div class="flex items-center">
                                            <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                            <span class="text-gray-800 font-medium">${item}</span>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
                slidesContainer.appendChild(slide);

                // 創建指示器
                const indicator = document.createElement('button');
                indicator.className = `w-3 h-3 rounded-full transition duration-300 ${index === currentPostersIndex ? 'bg-blue-600' : 'bg-gray-300 hover:bg-gray-400'}`;
                indicator.addEventListener('click', () => showPosterSlide(index));
                indicatorsContainer.appendChild(indicator);
            });

            // 設置輪播控制
            setupPostersControls();
        }

        // 診所環境輪播控制
        function setupGalleryControls() {
            const prevBtn = document.getElementById('gallery-prev');
            const nextBtn = document.getElementById('gallery-next');
            
            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', () => {
                    currentGalleryIndex = currentGalleryIndex > 0 ? currentGalleryIndex - 1 : galleryImages.length - 1;
                    showGallerySlide(currentGalleryIndex);
                });
                
                nextBtn.addEventListener('click', () => {
                    currentGalleryIndex = currentGalleryIndex < galleryImages.length - 1 ? currentGalleryIndex + 1 : 0;
                    showGallerySlide(currentGalleryIndex);
                });
            }
        }

        function showGallerySlide(index) {
            currentGalleryIndex = index;
            const slidesContainer = document.getElementById('gallery-slides');
            const thumbnails = document.querySelectorAll('#gallery-thumbnails button');
            
            if (slidesContainer) {
                slidesContainer.style.transform = `translateX(-${index * 100}%)`;
            }
            
            // 更新縮圖狀態
            thumbnails.forEach((thumb, i) => {
                if (i === index) {
                    thumb.classList.add('ring-4', 'ring-blue-500');
                    thumb.classList.remove('opacity-70');
                } else {
                    thumb.classList.remove('ring-4', 'ring-blue-500');
                    thumb.classList.add('opacity-70');
                }
            });
        }

        // 宣傳畫報輪播控制
        function setupPostersControls() {
            const prevBtn = document.getElementById('posters-prev');
            const nextBtn = document.getElementById('posters-next');
            
            if (prevBtn && nextBtn) {
                prevBtn.addEventListener('click', () => {
                    currentPostersIndex = currentPostersIndex > 0 ? currentPostersIndex - 1 : postersData.length - 1;
                    showPosterSlide(currentPostersIndex);
                });
                
                nextBtn.addEventListener('click', () => {
                    currentPostersIndex = currentPostersIndex < postersData.length - 1 ? currentPostersIndex + 1 : 0;
                    showPosterSlide(currentPostersIndex);
                });
            }
            
            // 自動輪播
            setInterval(() => {
                currentPostersIndex = currentPostersIndex < postersData.length - 1 ? currentPostersIndex + 1 : 0;
                showPosterSlide(currentPostersIndex);
            }, 5000);
        }

        function showPosterSlide(index) {
            currentPostersIndex = index;
            const slidesContainer = document.getElementById('posters-slides');
            const indicators = document.querySelectorAll('#posters-indicators button');
            
            if (slidesContainer) {
                slidesContainer.style.transform = `translateX(-${index * 100}%)`;
            }
            
            // 更新指示器狀態
            indicators.forEach((indicator, i) => {
                if (i === index) {
                    indicator.classList.add('bg-blue-600');
                    indicator.classList.remove('bg-gray-300');
                } else {
                    indicator.classList.remove('bg-blue-600');
                    indicator.classList.add('bg-gray-300');
                }
            });
        }

        // 初始化事件監聽器
        function initializeEventListeners() {
            // 管理選單功能
            const adminMenuBtn = document.getElementById('admin-menu-btn');
            const adminDropdown = document.getElementById('admin-dropdown');
            const loginBtn = document.getElementById('login-btn');
            const logoutBtn = document.getElementById('logout-btn');
            const loginModal = document.getElementById('login-modal');
            const closeLogin = document.getElementById('close-login');
            const loginForm = document.getElementById('login-form');
            const settingsPanel = document.getElementById('settings-panel');
            const closeSettings = document.getElementById('close-settings');

            // 管理選單切換
            adminMenuBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                adminDropdown.classList.toggle('hidden');
            });

            // 點擊其他地方關閉選單
            document.addEventListener('click', () => {
                adminDropdown.classList.add('hidden');
            });

            // 登入按鈕
            loginBtn.addEventListener('click', () => {
                if (window.isLoggedIn) {
                    settingsPanel.classList.remove('hidden');
                    loadAppointments(); // 載入預約資料
                } else {
                    loginModal.classList.remove('hidden');
                }
                adminDropdown.classList.add('hidden');
            });

            // 登出按鈕
            logoutBtn.addEventListener('click', async () => {
                try {
                    await window.firebaseModules.signOut(window.firebaseAuth);
                    console.log('已登出');
                } catch (error) {
                    console.error('登出失敗:', error);
                }
                adminDropdown.classList.add('hidden');
            });

            // 關閉登入對話框
            closeLogin.addEventListener('click', () => {
                loginModal.classList.add('hidden');
                document.getElementById('login-error').classList.add('hidden');
            });

            // 關閉設置面板
            closeSettings.addEventListener('click', () => {
                settingsPanel.classList.add('hidden');
            });

            // 醫師對話框事件監聽器
            const doctorModal = document.getElementById('doctor-modal');
            const closeDoctorModal = document.getElementById('close-doctor-modal');
            const cancelDoctor = document.getElementById('cancel-doctor');
            const doctorForm = document.getElementById('doctor-form');
            const uploadPhotoBtn = document.getElementById('upload-photo-btn');
            const doctorPhotoFile = document.getElementById('doctor-photo-file');
            const doctorPhotoUrl = document.getElementById('doctor-photo-url');

            // 關閉醫師對話框
            closeDoctorModal.addEventListener('click', () => {
                doctorModal.classList.add('hidden');
            });

            cancelDoctor.addEventListener('click', () => {
                doctorModal.classList.add('hidden');
            });

            // 點擊背景關閉對話框
            doctorModal.addEventListener('click', (e) => {
                if (e.target === doctorModal) {
                    doctorModal.classList.add('hidden');
                }
            });

            // 照片上傳按鈕
            uploadPhotoBtn.addEventListener('click', () => {
                doctorPhotoFile.click();
            });

            // 檔案選擇處理
            doctorPhotoFile.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    handlePhotoUpload(file);
                }
            });

            // 照片網址輸入處理
            doctorPhotoUrl.addEventListener('input', (e) => {
                const url = e.target.value.trim();
                if (url) {
                    showPhotoPreview(url);
                } else {
                    clearPhotoPreview();
                }
            });

            // 醫師表單提交
            doctorForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                await saveDoctorData();
            });

            // 登入表單提交
            loginForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const email = document.getElementById('admin-email').value;
                const password = document.getElementById('admin-password').value;
                const loginError = document.getElementById('login-error');
                const loginText = document.getElementById('login-text');
                const loginLoading = document.getElementById('login-loading');

                // 顯示載入狀態
                loginText.textContent = '登入中...';
                loginLoading.classList.remove('hidden');
                loginError.classList.add('hidden');

                try {
                    await window.firebaseModules.signInWithEmailAndPassword(window.firebaseAuth, email, password);
                    loginModal.classList.add('hidden');
                    settingsPanel.classList.remove('hidden');
                    loadAppointments(); // 載入預約資料
                } catch (error) {
                    console.error('登入失敗:', error);
                    loginError.textContent = '登入失敗：' + error.message;
                    loginError.classList.remove('hidden');
                } finally {
                    // 恢復按鈕狀態
                    loginText.textContent = '登入';
                    loginLoading.classList.add('hidden');
                }
            });

            // 預約表單提交
            const appointmentForm = document.getElementById('appointment-form');
            appointmentForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                await submitAppointment();
            });

            // 設置分頁切換
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetTab = tab.dataset.tab;
                    
                    // 更新分頁按鈕狀態
                    document.querySelectorAll('.settings-tab').forEach(t => {
                        t.classList.remove('active', 'border-blue-600', 'text-blue-600');
                        t.classList.add('border-transparent', 'text-gray-500');
                    });
                    tab.classList.add('active', 'border-blue-600', 'text-blue-600');
                    tab.classList.remove('border-transparent', 'text-gray-500');
                    
                    // 顯示對應內容
                    document.querySelectorAll('.settings-content').forEach(content => {
                        content.classList.add('hidden');
                    });
                    document.getElementById(`${targetTab}-tab`).classList.remove('hidden');

                    // 載入對應資料
                    if (targetTab === 'doctors') {
                        renderDoctorsManagement();
                    } else if (targetTab === 'news') {
                        renderNewsManagement();
                    } else if (targetTab === 'testimonials') {
                        renderTestimonialsManagement();
                    } else if (targetTab === 'gallery') {
                        renderGalleryManagement();
                    } else if (targetTab === 'posters') {
                        renderPostersManagement();
                    }
                });
            });

            // 保存設置
            document.getElementById('save-settings').addEventListener('click', async () => {
                await saveSettings();
            });

            // 重新整理預約
            document.getElementById('refresh-appointments').addEventListener('click', async () => {
                await loadAppointments();
            });

            // 從 Firebase 重新載入
            document.getElementById('sync-from-firebase').addEventListener('click', async () => {
                await reloadFromFirebase();
            });

            // 套用內容變更
            document.getElementById('apply-content-changes').addEventListener('click', async () => {
                await applyContentChanges();
            });

            // 新增醫師
            document.getElementById('add-doctor').addEventListener('click', () => {
                addNewDoctor();
            });

            // 新增消息
            document.getElementById('add-news').addEventListener('click', () => {
                addNewNews();
            });

            // 新增見證
            document.getElementById('add-testimonial').addEventListener('click', () => {
                addNewTestimonial();
            });

            // 新增診所環境
            document.getElementById('add-gallery-item').addEventListener('click', () => {
                addNewGalleryItem();
            });

            // 新增宣傳畫報
            document.getElementById('add-poster-item').addEventListener('click', () => {
                addNewPosterItem();
            });

            // 套用樣式變更
            document.getElementById('apply-style-changes').addEventListener('click', async () => {
                await applyStyleChanges();
            });

            // 套用法律條款變更
            document.getElementById('apply-legal-changes').addEventListener('click', async () => {
                await applyLegalChanges();
            });



            // 法律條款連結
            document.getElementById('privacy-link').addEventListener('click', () => {
                showLegalModal('privacy');
            });

            document.getElementById('terms-link').addEventListener('click', () => {
                showLegalModal('terms');
            });

            document.getElementById('disclaimer-link').addEventListener('click', () => {
                showLegalModal('disclaimer');
            });

            // 關閉法律條款彈出視窗
            document.getElementById('close-legal-modal').addEventListener('click', () => {
                document.getElementById('legal-modal').classList.add('hidden');
            });
        }

        // 渲染醫師管理
        function renderDoctorsManagement() {
            const container = document.getElementById('doctors-management');
            container.innerHTML = '';

            currentDoctors.forEach((doctor, index) => {
                const doctorItem = document.createElement('div');
                doctorItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                // 決定顯示照片還是姓名縮寫
                const photoDisplay = doctor.photo ? 
                    `<img src="${doctor.photo}" alt="${doctor.name}" class="w-16 h-16 rounded-full object-cover border-2 border-blue-100">` :
                    `<div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center border-2 border-blue-200">
                        <span class="text-lg font-bold text-blue-600">${doctor.name.charAt(0)}</span>
                    </div>`;
                
                doctorItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-start space-x-4">
                            ${photoDisplay}
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-900 mb-2">${doctor.name} - ${doctor.title}</h4>
                                <div class="text-sm text-gray-600 space-y-1">
                                    <p><strong>專長:</strong> ${doctor.specialty}</p>
                                    <p><strong>經驗:</strong> ${doctor.experience}</p>
                                    <p><strong>學歷:</strong> ${doctor.education}</p>
                                    <p><strong>簡介:</strong> ${doctor.description}</p>
                                    ${doctor.photo ? `<p><strong>照片:</strong> <span class="text-xs text-blue-600">已上傳</span></p>` : '<p><strong>照片:</strong> <span class="text-xs text-gray-400">未上傳</span></p>'}
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editDoctor(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deleteDoctor(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(doctorItem);
            });
        }

        // 渲染消息管理
        function renderNewsManagement() {
            const container = document.getElementById('news-management');
            container.innerHTML = '';

            currentNews.forEach((news, index) => {
                const newsItem = document.createElement('div');
                newsItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                const importantBadge = news.important ? 
                    '<span class="bg-red-100 text-red-800 px-2 py-1 rounded text-xs font-semibold ml-2">重要</span>' : '';
                
                newsItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h4 class="font-bold text-gray-900">${news.title}</h4>
                                ${importantBadge}
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>分類:</strong> ${news.category}</p>
                                <p><strong>日期:</strong> ${news.date}</p>
                                <p><strong>內容:</strong> ${news.content}</p>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editNews(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deleteNews(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(newsItem);
            });
        }

        // 全域變數
        let currentEditingDoctorIndex = -1;

        // 新增醫師
        function addNewDoctor() {
            currentEditingDoctorIndex = -1;
            document.getElementById('doctor-modal-title').textContent = '新增醫師';
            clearDoctorForm();
            document.getElementById('doctor-modal').classList.remove('hidden');
        }

        // 編輯醫師
        function editDoctor(index) {
            currentEditingDoctorIndex = index;
            const doctor = currentDoctors[index];
            
            document.getElementById('doctor-modal-title').textContent = '編輯醫師資料';
            
            // 填入現有資料
            document.getElementById('doctor-name').value = doctor.name || '';
            document.getElementById('doctor-title').value = doctor.title || '';
            document.getElementById('doctor-specialty').value = doctor.specialty || '';
            document.getElementById('doctor-experience').value = doctor.experience || '';
            document.getElementById('doctor-education').value = doctor.education || '';
            document.getElementById('doctor-description').value = doctor.description || '';
            document.getElementById('doctor-photo-url').value = doctor.photo || '';
            
            // 顯示照片預覽
            if (doctor.photo) {
                showPhotoPreview(doctor.photo);
            } else {
                clearPhotoPreview();
            }
            
            document.getElementById('doctor-modal').classList.remove('hidden');
        }

        // 清空醫師表單
        function clearDoctorForm() {
            document.getElementById('doctor-form').reset();
            clearPhotoPreview();
        }

        // 顯示照片預覽
        function showPhotoPreview(photoUrl) {
            const placeholder = document.getElementById('doctor-photo-placeholder');
            const img = document.getElementById('doctor-photo-img');
            
            img.src = photoUrl;
            img.classList.remove('hidden');
            placeholder.classList.add('hidden');
            
            // 處理圖片載入錯誤
            img.onerror = function() {
                clearPhotoPreview();
            };
        }

        // 清空照片預覽
        function clearPhotoPreview() {
            const placeholder = document.getElementById('doctor-photo-placeholder');
            const img = document.getElementById('doctor-photo-img');
            
            img.classList.add('hidden');
            placeholder.classList.remove('hidden');
            img.src = '';
        }

        // 處理檔案上傳
        function handlePhotoUpload(file) {
            if (!file) return;
            
            // 檢查檔案類型
            if (!file.type.startsWith('image/')) {
                alert('請選擇圖片檔案！');
                return;
            }
            
            // 檢查檔案大小（限制 5MB）
            if (file.size > 5 * 1024 * 1024) {
                alert('圖片檔案不能超過 5MB！');
                return;
            }
            
            // 使用 FileReader 讀取檔案
            const reader = new FileReader();
            reader.onload = function(e) {
                const photoUrl = e.target.result;
                document.getElementById('doctor-photo-url').value = photoUrl;
                showPhotoPreview(photoUrl);
            };
            reader.readAsDataURL(file);
        }

        // 保存醫師資料
        async function saveDoctorData() {
            const saveText = document.getElementById('save-doctor-text');
            const saveLoading = document.getElementById('save-doctor-loading');
            
            saveText.textContent = '保存中...';
            saveLoading.classList.remove('hidden');
            
            try {
                const doctorData = {
                    name: document.getElementById('doctor-name').value.trim(),
                    title: document.getElementById('doctor-title').value.trim() || '主治醫師',
                    specialty: document.getElementById('doctor-specialty').value.trim(),
                    experience: document.getElementById('doctor-experience').value.trim(),
                    education: document.getElementById('doctor-education').value.trim(),
                    description: document.getElementById('doctor-description').value.trim(),
                    photo: document.getElementById('doctor-photo-url').value.trim()
                };
                
                // 驗證必填欄位
                if (!doctorData.name) {
                    alert('請輸入醫師姓名！');
                    return;
                }
                
                // 新增或更新醫師
                if (currentEditingDoctorIndex === -1) {
                    // 新增醫師
                    currentDoctors.push(doctorData);
                } else {
                    // 更新醫師
                    currentDoctors[currentEditingDoctorIndex] = doctorData;
                }
                
                // 重新渲染
                renderDoctors();
                renderDoctorsManagement();
                
                // 保存到 Firebase
                if (window.FirebaseManager) {
                    await window.FirebaseManager.saveDoctors(currentDoctors);
                }
                
                // 關閉對話框
                document.getElementById('doctor-modal').classList.add('hidden');
                
                alert('醫師資料已保存！');
                
            } catch (error) {
                console.error('保存醫師資料失敗:', error);
                alert('保存醫師資料時發生錯誤：' + error.message);
            } finally {
                saveText.textContent = '保存';
                saveLoading.classList.add('hidden');
            }
        }

        // 刪除醫師
        function deleteDoctor(index) {
            if (confirm('確定要刪除這位醫師嗎？')) {
                currentDoctors.splice(index, 1);
                renderDoctors();
                renderDoctorsManagement();
                
                // 保存到 Firebase
                if (window.FirebaseManager) {
                    window.FirebaseManager.saveDoctors(currentDoctors);
                }
            }
        }

        // 新增消息
        function addNewNews() {
            const title = prompt('請輸入消息標題:');
            if (!title) return;
            
            const category = prompt('請輸入分類:') || '一般公告';
            const content = prompt('請輸入內容:') || '';
            const important = confirm('是否為重要消息？');
            const date = new Date().toISOString().split('T')[0];

            const newNews = {
                title,
                category,
                content,
                important,
                date
            };

            currentNews.unshift(newNews); // 新消息放在最前面
            renderNews();
            renderNewsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveNews(currentNews);
            }
        }

        // 編輯消息
        function editNews(index) {
            const news = currentNews[index];
            
            const title = prompt('請輸入消息標題:', news.title);
            if (!title) return;
            
            const category = prompt('請輸入分類:', news.category);
            const content = prompt('請輸入內容:', news.content);
            const important = confirm('是否為重要消息？');

            currentNews[index] = {
                ...news,
                title,
                category: category || news.category,
                content: content || news.content,
                important
            };

            renderNews();
            renderNewsManagement();
            
            // 保存到 Firebase
            if (window.FirebaseManager) {
                window.FirebaseManager.saveNews(currentNews);
            }
        }

        // 刪除消息
        function deleteNews(index) {
            if (confirm('確定要刪除這則消息嗎？')) {
                currentNews.splice(index, 1);
                renderNews();
                renderNewsManagement();
                
                // 保存到 Firebase
                if (window.FirebaseManager) {
                    window.FirebaseManager.saveNews(currentNews);
                }
            }
        }

        // 提交預約
        async function submitAppointment() {
            const submitText = document.getElementById('submit-text');
            const submitLoading = document.getElementById('submit-loading');
            
            // 顯示載入狀態
            submitText.textContent = '提交中...';
            submitLoading.classList.remove('hidden');

            try {
                const appointmentData = {
                    patientName: document.getElementById('patient-name').value,
                    patientPhone: document.getElementById('patient-phone').value,
                    patientEmail: document.getElementById('patient-email').value,
                    preferredDoctor: document.getElementById('preferred-doctor').value,
                    preferredDate: document.getElementById('preferred-date').value,
                    symptoms: document.getElementById('symptoms').value
                };

                if (window.FirebaseManager) {
                    const appointmentId = await window.FirebaseManager.saveAppointment(appointmentData);
                    if (appointmentId) {
                        alert('預約申請已提交成功！我們將盡快與您聯繫確認預約時間。\n\n預約編號：' + appointmentId);
                        document.getElementById('appointment-form').reset();
                    } else {
                        throw new Error('儲存預約資料失敗');
                    }
                } else {
                    // 如果 Firebase 不可用，顯示提示訊息
                    alert('感謝您的預約申請！我們將盡快與您聯繫確認預約時間。\n\n實際預約請致電：(02) 2345-6789');
                    document.getElementById('appointment-form').reset();
                }
            } catch (error) {
                console.error('提交預約失敗:', error);
                alert('提交預約時發生錯誤，請稍後再試或直接致電診所。');
            } finally {
                // 恢復按鈕狀態
                submitText.textContent = '提交預約申請';
                submitLoading.classList.add('hidden');
            }
        }

        // 載入預約資料
        async function loadAppointments() {
            const refreshLoading = document.getElementById('refresh-loading');
            const appointmentsList = document.getElementById('appointments-list');
            
            refreshLoading.classList.remove('hidden');
            
            try {
                if (window.FirebaseManager) {
                    const appointments = await window.FirebaseManager.loadAppointments();
                    renderAppointmentsList(appointments);
                } else {
                    appointmentsList.innerHTML = '<p class="text-gray-500">Firebase 未連接</p>';
                }
            } catch (error) {
                console.error('載入預約資料失敗:', error);
                appointmentsList.innerHTML = '<p class="text-red-500">載入預約資料失敗</p>';
            } finally {
                refreshLoading.classList.add('hidden');
            }
        }

        // 渲染預約列表
        function renderAppointmentsList(appointments) {
            const appointmentsList = document.getElementById('appointments-list');
            appointmentsList.innerHTML = '';
            
            if (appointments.length === 0) {
                appointmentsList.innerHTML = '<p class="text-gray-500">目前沒有預約資料</p>';
                return;
            }
            
            appointments.forEach(appointment => {
                const appointmentItem = document.createElement('div');
                appointmentItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                const statusColor = {
                    'pending': 'yellow',
                    'confirmed': 'green',
                    'cancelled': 'red',
                    'completed': 'blue'
                }[appointment.status] || 'gray';
                
                const statusText = {
                    'pending': '待確認',
                    'confirmed': '已確認',
                    'cancelled': '已取消',
                    'completed': '已完成'
                }[appointment.status] || '未知';
                
                appointmentItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center mb-2">
                                <h4 class="font-bold text-gray-900 mr-4">${appointment.patientName}</h4>
                                <span class="bg-${statusColor}-100 text-${statusColor}-800 px-2 py-1 rounded text-xs font-semibold">
                                    ${statusText}
                                </span>
                            </div>
                            <div class="text-sm text-gray-600 space-y-1">
                                <p><strong>電話:</strong> ${appointment.patientPhone}</p>
                                ${appointment.patientEmail ? `<p><strong>信箱:</strong> ${appointment.patientEmail}</p>` : ''}
                                ${appointment.preferredDoctor ? `<p><strong>指定醫師:</strong> ${appointment.preferredDoctor}</p>` : ''}
                                ${appointment.preferredDate ? `<p><strong>希望日期:</strong> ${appointment.preferredDate}</p>` : ''}
                                ${appointment.symptoms ? `<p><strong>症狀:</strong> ${appointment.symptoms}</p>` : ''}
                                <p><strong>預約時間:</strong> ${appointment.createdAt?.toDate?.()?.toLocaleString('zh-TW') || '未知'}</p>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            ${appointment.status === 'pending' ? `
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'confirmed')" class="text-green-600 hover:text-green-800 text-sm">確認</button>
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'cancelled')" class="text-red-600 hover:text-red-800 text-sm">取消</button>
                            ` : ''}
                            ${appointment.status === 'confirmed' ? `
                                <button onclick="updateAppointmentStatus('${appointment.id}', 'completed')" class="text-blue-600 hover:text-blue-800 text-sm">完成</button>
                            ` : ''}
                        </div>
                    </div>
                `;
                appointmentsList.appendChild(appointmentItem);
            });
        }

        // 更新預約狀態
        async function updateAppointmentStatus(appointmentId, status) {
            try {
                if (window.FirebaseManager) {
                    const success = await window.FirebaseManager.updateAppointmentStatus(appointmentId, status);
                    if (success) {
                        await loadAppointments(); // 重新載入列表
                    } else {
                        alert('更新預約狀態失敗');
                    }
                }
            } catch (error) {
                console.error('更新預約狀態失敗:', error);
                alert('更新預約狀態時發生錯誤');
            }
        }

        // 保存設置
        async function saveSettings() {
            const saveLoading = document.getElementById('save-loading');
            saveLoading.classList.remove('hidden');
            
            try {
                const settings = {
                    clinicName: document.getElementById('clinic-name').value,
                    clinicAddress: document.getElementById('clinic-address').value,
                    clinicPhone: document.getElementById('clinic-phone').value
                };

                // 保存到 Firebase
                if (window.FirebaseManager) {
                    const success = await window.FirebaseManager.saveSettings(settings);
                    if (success) {
                        // 應用設置到頁面
                        applySettings(settings);
                        alert('設置已保存到 Firebase！');
                    } else {
                        throw new Error('保存到 Firebase 失敗');
                    }
                } else {
                    throw new Error('Firebase 未連接');
                }
            } catch (error) {
                console.error('保存設置失敗:', error);
                alert('保存設置時發生錯誤：' + error.message);
            } finally {
                saveLoading.classList.add('hidden');
            }
        }

        // 套用內容變更
        async function applyContentChanges() {
            const applyContentLoading = document.getElementById('apply-content-loading');
            applyContentLoading.classList.remove('hidden');
            
            try {
                // 收集所有內容變更
                const contentChanges = {
                    heroTitle: document.getElementById('hero-title').value,
                    heroSubtitle: document.getElementById('hero-subtitle').value,
                    heroDescription: document.getElementById('hero-description').value,
                    heroBtn1: document.getElementById('hero-btn1').value,
                    heroBtn2: document.getElementById('hero-btn2').value,
                    aboutTitle: document.getElementById('about-title').value,
                    aboutDescription: document.getElementById('about-description').value,
                    missionTitle: document.getElementById('mission-title').value,
                    servicesTitle: document.getElementById('services-title').value,
                    servicesDescription: document.getElementById('services-description').value,
                    doctorsTitle: document.getElementById('doctors-title').value,
                    doctorsDescription: document.getElementById('doctors-description').value,
                    galleryTitle: document.getElementById('gallery-title').value,
                    galleryDescription: document.getElementById('gallery-description').value,
                    postersTitle: document.getElementById('posters-title').value,
                    postersDescription: document.getElementById('posters-description').value,
                    newsTitle: document.getElementById('news-title').value,
                    newsDescription: document.getElementById('news-description').value,
                    testimonialsTitle: document.getElementById('testimonials-title').value,
                    testimonialsDescription: document.getElementById('testimonials-description').value,
                    contactTitle: document.getElementById('contact-title').value,
                    contactDescription: document.getElementById('contact-description').value,
                    clinicEmail: document.getElementById('clinic-email').value,
                    clinicHours: document.getElementById('clinic-hours').value,
                    clinicTransport: document.getElementById('clinic-transport').value,
                    appointmentFormTitle: document.getElementById('appointment-form-title').value,
                    appointmentBtnText: document.getElementById('appointment-btn-text').value,
                    footerSlogan: document.getElementById('footer-slogan').value,
                    footerCopyright: document.getElementById('footer-copyright').value,
                    floatingBtnText: document.getElementById('floating-btn-text').value
                };

                // 更新主視覺區
                const heroTitleElement = document.querySelector('#home h1');
                if (heroTitleElement) {
                    heroTitleElement.innerHTML = `${contentChanges.heroTitle}<br><span class="text-cyan-300">${contentChanges.heroSubtitle}</span>`;
                }

                const heroDescElement = document.querySelector('#home p.text-xl');
                if (heroDescElement) {
                    heroDescElement.textContent = contentChanges.heroDescription;
                }

                // 更新主視覺區按鈕
                const heroBtn1 = document.querySelector('#home button:first-of-type');
                if (heroBtn1) {
                    heroBtn1.textContent = contentChanges.heroBtn1;
                }

                const heroBtn2 = document.querySelector('#home button:last-of-type');
                if (heroBtn2) {
                    heroBtn2.textContent = contentChanges.heroBtn2;
                }

                // 更新關於我們
                const aboutTitleElement = document.querySelector('#about h2');
                if (aboutTitleElement) {
                    aboutTitleElement.textContent = contentChanges.aboutTitle;
                }

                const aboutDescElement = document.querySelector('#about .text-center p.text-xl');
                if (aboutDescElement) {
                    aboutDescElement.textContent = contentChanges.aboutDescription;
                }

                const missionTitleElement = document.querySelector('#about h3');
                if (missionTitleElement) {
                    missionTitleElement.textContent = contentChanges.missionTitle;
                }

                // 更新診療項目
                const servicesTitleElement = document.querySelector('#services h2');
                if (servicesTitleElement) {
                    servicesTitleElement.textContent = contentChanges.servicesTitle;
                }

                const servicesDescElement = document.querySelector('#services .text-center p.text-xl');
                if (servicesDescElement) {
                    servicesDescElement.textContent = contentChanges.servicesDescription;
                }

                // 更新醫師團隊
                const doctorsTitleElement = document.querySelector('#doctors h2');
                if (doctorsTitleElement) {
                    doctorsTitleElement.textContent = contentChanges.doctorsTitle;
                }

                const doctorsDescElement = document.querySelector('#doctors .text-center p.text-xl');
                if (doctorsDescElement) {
                    doctorsDescElement.textContent = contentChanges.doctorsDescription;
                }

                // 更新診所環境
                const galleryTitleElement = document.querySelector('#gallery h2');
                if (galleryTitleElement) {
                    galleryTitleElement.textContent = contentChanges.galleryTitle;
                }

                const galleryDescElement = document.querySelector('#gallery .text-center p.text-xl');
                if (galleryDescElement) {
                    galleryDescElement.textContent = contentChanges.galleryDescription;
                }

                // 更新宣傳畫報
                const postersTitleElement = document.querySelector('#posters h2');
                if (postersTitleElement) {
                    postersTitleElement.textContent = contentChanges.postersTitle;
                }

                const postersDescElement = document.querySelector('#posters .text-center p.text-xl');
                if (postersDescElement) {
                    postersDescElement.textContent = contentChanges.postersDescription;
                }

                // 更新最新消息
                const newsTitleElement = document.querySelector('#news h2');
                if (newsTitleElement) {
                    newsTitleElement.textContent = contentChanges.newsTitle;
                }

                const newsDescElement = document.querySelector('#news .text-center p.text-xl');
                if (newsDescElement) {
                    newsDescElement.textContent = contentChanges.newsDescription;
                }

                // 更新患者見證
                const testimonialsTitleElements = document.querySelectorAll('h2');
                testimonialsTitleElements.forEach(el => {
                    if (el.textContent.includes('患者見證')) {
                        el.textContent = contentChanges.testimonialsTitle;
                    }
                });

                const testimonialsDescElements = document.querySelectorAll('p.text-xl');
                testimonialsDescElements.forEach(el => {
                    if (el.textContent.includes('真實的治療經驗分享')) {
                        el.textContent = contentChanges.testimonialsDescription;
                    }
                });

                // 更新聯絡我們
                const contactTitleElement = document.querySelector('#contact h2');
                if (contactTitleElement) {
                    contactTitleElement.textContent = contentChanges.contactTitle;
                }

                const contactDescElement = document.querySelector('#contact .text-center p.text-xl');
                if (contactDescElement) {
                    contactDescElement.textContent = contentChanges.contactDescription;
                }

                // 更新預約表單標題
                const appointmentFormTitleElement = document.querySelector('#contact h3');
                if (appointmentFormTitleElement && appointmentFormTitleElement.textContent.includes('線上預約')) {
                    appointmentFormTitleElement.textContent = contentChanges.appointmentFormTitle;
                }

                // 更新預約按鈕
                const appointmentBtnElement = document.querySelector('#submit-appointment #submit-text');
                if (appointmentBtnElement) {
                    appointmentBtnElement.textContent = contentChanges.appointmentBtnText;
                }

                // 更新頁尾
                const footerSloganElement = document.querySelector('footer p');
                if (footerSloganElement && footerSloganElement.textContent.includes('傳承千年智慧')) {
                    footerSloganElement.textContent = contentChanges.footerSlogan;
                }

                const footerCopyrightElement = document.querySelector('footer .text-center p');
                if (footerCopyrightElement && footerCopyrightElement.textContent.includes('©')) {
                    footerCopyrightElement.textContent = contentChanges.footerCopyright;
                }

                // 更新浮動按鈕
                const floatingBtnElement = document.querySelector('.floating-btn');
                if (floatingBtnElement) {
                    floatingBtnElement.textContent = contentChanges.floatingBtnText;
                }

                // 更新聯絡資訊
                const emailElements = document.querySelectorAll('span, p');
                emailElements.forEach(el => {
                    if (el.textContent.includes('info@renxin-tcm.com.tw')) {
                        el.textContent = contentChanges.clinicEmail;
                    }
                });

                // 更新門診時間
                const hoursElements = document.querySelectorAll('.text-gray-600, .text-gray-400');
                hoursElements.forEach(el => {
                    if (el.textContent.includes('週一至週五') || el.textContent.includes('週一至週六')) {
                        const lines = contentChanges.clinicHours.split('\n');
                        if (lines.length >= 3) {
                            el.innerHTML = lines.map(line => `<p>${line}</p>`).join('');
                        }
                    }
                });

                // 更新交通資訊
                const transportElements = document.querySelectorAll('.text-gray-600');
                transportElements.forEach(el => {
                    if (el.textContent.includes('捷運：中正紀念堂站')) {
                        const lines = contentChanges.clinicTransport.split('\n');
                        if (lines.length >= 3) {
                            el.innerHTML = lines.map(line => `<p>${line}</p>`).join('');
                        }
                    }
                });

                // 保存到 Firebase
                if (window.FirebaseManager) {
                    const currentSettings = await window.FirebaseManager.loadSettings() || {};
                    const updatedSettings = {
                        ...currentSettings,
                        ...contentChanges,
                        updatedAt: new Date()
                    };
                    await window.FirebaseManager.saveSettings(updatedSettings);
                }

                alert('內容變更已套用到網頁！');
                
            } catch (error) {
                console.error('套用內容變更失敗:', error);
                alert('套用內容變更時發生錯誤：' + error.message);
            } finally {
                applyContentLoading.classList.add('hidden');
            }
        }

        // 重新載入 Firebase 資料
        async function reloadFromFirebase() {
            const syncFromLoading = document.getElementById('sync-from-loading');
            const syncStatus = document.getElementById('sync-status');
            
            syncFromLoading.classList.remove('hidden');
            syncStatus.textContent = '正在從 Firebase 重新載入...';
            
            try {
                if (!window.FirebaseManager) {
                    throw new Error('Firebase 未初始化');
                }

                // 從 Firebase 載入設置
                const firebaseSettings = await window.FirebaseManager.loadSettings();
                
                if (firebaseSettings) {
                    // 應用設置到頁面
                    applySettings(firebaseSettings);
                    
                    // 更新設置面板的值
                    if (document.getElementById('clinic-name')) {
                        document.getElementById('clinic-name').value = firebaseSettings.clinicName || '仁心中醫診所';
                        document.getElementById('clinic-address').value = firebaseSettings.clinicAddress || '台北市中正區健康路123號';
                        document.getElementById('clinic-phone').value = firebaseSettings.clinicPhone || '(02) 2345-6789';
                        
                        // 更新內容編輯欄位
                        if (document.getElementById('hero-title')) {
                            document.getElementById('hero-title').value = firebaseSettings.heroTitle || '傳承千年智慧';
                            document.getElementById('hero-subtitle').value = firebaseSettings.heroSubtitle || '守護現代健康';
                            document.getElementById('hero-description').value = firebaseSettings.heroDescription || '結合傳統中醫精髓與現代醫學技術，為您提供全方位的健康照護服務。專業醫師團隊，用心呵護每一位患者的健康。';
                            document.getElementById('about-title').value = firebaseSettings.aboutTitle || '關於仁心中醫診所';
                            document.getElementById('about-description').value = firebaseSettings.aboutDescription || '秉承「仁心仁術，濟世救人」的理念，我們致力於傳承中醫文化，結合現代醫學技術，為患者提供最優質的醫療服務。';
                            document.getElementById('services-title').value = firebaseSettings.servicesTitle || '診療項目';
                            document.getElementById('services-description').value = firebaseSettings.servicesDescription || '提供全方位的中醫診療服務，守護您的健康';
                            document.getElementById('doctors-title').value = firebaseSettings.doctorsTitle || '專業醫師團隊';
                            document.getElementById('doctors-description').value = firebaseSettings.doctorsDescription || '經驗豐富的中醫師，為您提供專業的醫療服務';
                            document.getElementById('contact-title').value = firebaseSettings.contactTitle || '聯絡我們';
                            document.getElementById('contact-description').value = firebaseSettings.contactDescription || '歡迎預約諮詢，我們將竭誠為您服務';
                            document.getElementById('clinic-email').value = firebaseSettings.clinicEmail || 'info@renxin-tcm.com.tw';
                            document.getElementById('clinic-hours').value = firebaseSettings.clinicHours || '週一至週五：09:00-12:00, 14:00-17:00, 18:00-21:00\n週六：09:00-12:00, 14:00-17:00\n週日：休診';
                            document.getElementById('clinic-transport').value = firebaseSettings.clinicTransport || '捷運：中正紀念堂站2號出口，步行3分鐘\n公車：15, 18, 236, 295路線\n停車：診所附近有多個付費停車場';
                            
                            // 更新法律條款欄位
                            document.getElementById('privacy-title').value = firebaseSettings.privacyTitle || '隱私政策';
                            document.getElementById('privacy-content').value = firebaseSettings.privacyContent || getDefaultPrivacyContent();
                            document.getElementById('terms-title').value = firebaseSettings.termsTitle || '服務條款';
                            document.getElementById('terms-content').value = firebaseSettings.termsContent || getDefaultTermsContent();
                            document.getElementById('disclaimer-title').value = firebaseSettings.disclaimerTitle || '免責聲明';
                            document.getElementById('disclaimer-content').value = firebaseSettings.disclaimerContent || getDefaultDisclaimerContent();
                        }
                    }
                }

                // 重新載入醫師資料
                const doctors = await window.FirebaseManager.loadDoctors();
                if (doctors.length > 0) {
                    currentDoctors = doctors;
                    renderDoctors();
                }

                // 重新載入最新消息
                const news = await window.FirebaseManager.loadNews();
                if (news.length > 0) {
                    currentNews = news;
                    renderNews();
                }

                // 重新載入診所環境和宣傳畫報
                if (firebaseSettings.galleryImages) {
                    galleryImages = firebaseSettings.galleryImages;
                    renderGallery();
                }
                
                if (firebaseSettings.postersData) {
                    postersData = firebaseSettings.postersData;
                    renderPosters();
                }
                
                syncStatus.textContent = '重新載入完成！頁面已更新為最新的 Firebase 資料。';
                syncStatus.className = 'p-4 rounded-lg bg-green-50 text-sm text-green-600';
            } catch (error) {
                console.error('從 Firebase 載入失敗:', error);
                syncStatus.textContent = '載入失敗：' + error.message;
                syncStatus.className = 'p-4 rounded-lg bg-red-50 text-sm text-red-600';
            } finally {
                syncFromLoading.classList.add('hidden');
            }
        }

        // 套用法律條款變更
        async function applyLegalChanges() {
            const applyLegalLoading = document.getElementById('apply-legal-loading');
            applyLegalLoading.classList.remove('hidden');
            
            try {
                const legalChanges = {
                    privacyTitle: document.getElementById('privacy-title').value,
                    privacyContent: document.getElementById('privacy-content').value,
                    termsTitle: document.getElementById('terms-title').value,
                    termsContent: document.getElementById('terms-content').value,
                    disclaimerTitle: document.getElementById('disclaimer-title').value,
                    disclaimerContent: document.getElementById('disclaimer-content').value
                };

                // 保存到 Firebase
                if (window.FirebaseManager) {
                    const currentSettings = await window.FirebaseManager.loadSettings() || {};
                    const updatedSettings = {
                        ...currentSettings,
                        ...legalChanges,
                        updatedAt: new Date()
                    };
                    await window.FirebaseManager.saveSettings(updatedSettings);
                }

                alert('法律條款變更已保存！');
                
            } catch (error) {
                console.error('套用法律條款變更失敗:', error);
                alert('套用法律條款變更時發生錯誤：' + error.message);
            } finally {
                applyLegalLoading.classList.add('hidden');
            }
        }

        // 顯示法律條款彈出視窗
        async function showLegalModal(type) {
            const modal = document.getElementById('legal-modal');
            const title = document.getElementById('legal-modal-title');
            const content = document.getElementById('legal-modal-content');
            
            let titleText = '';
            let contentText = '';
            
            try {
                // 從 Firebase 載入最新的法律條款
                if (window.FirebaseManager) {
                    const settings = await window.FirebaseManager.loadSettings();
                    
                    if (type === 'privacy') {
                        titleText = settings?.privacyTitle || '隱私政策';
                        contentText = settings?.privacyContent || getDefaultPrivacyContent();
                    } else if (type === 'terms') {
                        titleText = settings?.termsTitle || '服務條款';
                        contentText = settings?.termsContent || getDefaultTermsContent();
                    } else if (type === 'disclaimer') {
                        titleText = settings?.disclaimerTitle || '免責聲明';
                        contentText = settings?.disclaimerContent || getDefaultDisclaimerContent();
                    }
                } else {
                    // Firebase 不可用時使用預設內容
                    if (type === 'privacy') {
                        titleText = '隱私政策';
                        contentText = getDefaultPrivacyContent();
                    } else if (type === 'terms') {
                        titleText = '服務條款';
                        contentText = getDefaultTermsContent();
                    } else if (type === 'disclaimer') {
                        titleText = '免責聲明';
                        contentText = getDefaultDisclaimerContent();
                    }
                }
            } catch (error) {
                console.error('載入法律條款失敗:', error);
                // 使用預設內容
                if (type === 'privacy') {
                    titleText = '隱私政策';
                    contentText = getDefaultPrivacyContent();
                } else if (type === 'terms') {
                    titleText = '服務條款';
                    contentText = getDefaultTermsContent();
                } else if (type === 'disclaimer') {
                    titleText = '免責聲明';
                    contentText = getDefaultDisclaimerContent();
                }
            }
            
            title.textContent = titleText;
            content.innerHTML = `<pre class="whitespace-pre-wrap font-sans text-gray-700 leading-relaxed">${contentText}</pre>`;
            modal.classList.remove('hidden');
        }

        // 預設隱私政策內容
        function getDefaultPrivacyContent() {
            return document.getElementById('privacy-content').value;
        }

        // 預設服務條款內容
        function getDefaultTermsContent() {
            return document.getElementById('terms-content').value;
        }

        // 預設免責聲明內容
        function getDefaultDisclaimerContent() {
            return document.getElementById('disclaimer-content').value;
        }

        // 渲染診所環境管理
        function renderGalleryManagement() {
            const container = document.getElementById('gallery-management');
            container.innerHTML = '';

            galleryImages.forEach((image, index) => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                galleryItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-start space-x-4">
                            <div class="w-16 h-16 rounded-lg overflow-hidden bg-gray-200">
                                <img src="${image.imageUrl}" alt="${image.title}" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-900 mb-2">${image.title}</h4>
                                <div class="text-xs text-gray-500">
                                    <span class="bg-gray-200 px-2 py-1 rounded">圖片: ${image.imageUrl}</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editGalleryItem(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deleteGalleryItem(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(galleryItem);
            });
        }

        // 渲染宣傳畫報管理
        function renderPostersManagement() {
            const container = document.getElementById('posters-management');
            container.innerHTML = '';

            postersData.forEach((poster, index) => {
                const posterItem = document.createElement('div');
                posterItem.className = 'bg-gray-50 p-4 rounded-lg';
                
                posterItem.innerHTML = `
                    <div class="flex justify-between items-start">
                        <div class="flex items-start space-x-4">
                            <div class="w-16 h-16 rounded-lg overflow-hidden bg-gray-200">
                                <img src="${poster.imageUrl}" alt="${poster.title}" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1">
                                <h4 class="font-bold text-gray-900 mb-2">${poster.title}</h4>
                                <div class="text-xs text-gray-500">
                                    <span class="bg-gray-200 px-2 py-1 rounded">圖片: ${poster.imageUrl}</span>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col space-y-2 ml-4">
                            <button onclick="editPosterItem(${index})" class="text-blue-600 hover:text-blue-800 text-sm">編輯</button>
                            <button onclick="deletePosterItem(${index})" class="text-red-600 hover:text-red-800 text-sm">刪除</button>
                        </div>
                    </div>
                `;
                container.appendChild(posterItem);
            });
        }

        // 新增診所環境項目
        function addNewGalleryItem() {
            const title = prompt('請輸入環境名稱（例如：診療室、候診區）:');
            if (!title) return;
            
            const imageUrl = prompt('請輸入圖片網址:') || 'https://via.placeholder.com/800x600/3B82F6/FFFFFF?text=' + encodeURIComponent(title);

            const newGalleryItem = {
                title,
                imageUrl
            };

            galleryImages.push(newGalleryItem);
            renderGallery();
            renderGalleryManagement();
            
            // 保存到 Firebase
            saveGalleryToFirebase();
        }

        // 編輯診所環境項目
        function editGalleryItem(index) {
            const item = galleryImages[index];
            
            const title = prompt('請輸入環境名稱:', item.title);
            if (!title) return;
            
            const imageUrl = prompt('請輸入圖片網址:', item.imageUrl);

            galleryImages[index] = {
                title,
                imageUrl: imageUrl || item.imageUrl
            };

            renderGallery();
            renderGalleryManagement();
            
            // 保存到 Firebase
            saveGalleryToFirebase();
        }

        // 刪除診所環境項目
        function deleteGalleryItem(index) {
            if (confirm('確定要刪除這個環境項目嗎？')) {
                galleryImages.splice(index, 1);
                renderGallery();
                renderGalleryManagement();
                
                // 保存到 Firebase
                saveGalleryToFirebase();
            }
        }

        // 新增宣傳畫報項目
        function addNewPosterItem() {
            const title = prompt('請輸入畫報標題（例如：春季養生、夏季養心）:');
            if (!title) return;
            
            const imageUrl = prompt('請輸入圖片網址:') || 'https://via.placeholder.com/800x600/3B82F6/FFFFFF?text=' + encodeURIComponent(title);

            const newPosterItem = {
                title,
                imageUrl
            };

            postersData.push(newPosterItem);
            renderPosters();
            renderPostersManagement();
            
            // 保存到 Firebase
            savePostersToFirebase();
        }

        // 編輯宣傳畫報項目
        function editPosterItem(index) {
            const item = postersData[index];
            
            const title = prompt('請輸入畫報標題:', item.title);
            if (!title) return;
            
            const imageUrl = prompt('請輸入圖片網址:', item.imageUrl);

            postersData[index] = {
                title,
                imageUrl: imageUrl || item.imageUrl
            };

            renderPosters();
            renderPostersManagement();
            
            // 保存到 Firebase
            savePostersToFirebase();
        }

        // 刪除宣傳畫報項目
        function deletePosterItem(index) {
            if (confirm('確定要刪除這個畫報嗎？')) {
                postersData.splice(index, 1);
                renderPosters();
                renderPostersManagement();
                
                // 保存到 Firebase
                savePostersToFirebase();
            }
        }

        // 保存診所環境到 Firebase
        async function saveGalleryToFirebase() {
            if (window.FirebaseManager) {
                try {
                    const currentSettings = await window.FirebaseManager.loadSettings() || {};
                    const updatedSettings = {
                        ...currentSettings,
                        galleryImages,
                        updatedAt: new Date()
                    };
                    await window.FirebaseManager.saveSettings(updatedSettings);
                    console.log('診所環境已保存到 Firebase');
                } catch (error) {
                    console.error('保存診所環境失敗:', error);
                }
            }
        }

        // 保存宣傳畫報到 Firebase
        async function savePostersToFirebase() {
            if (window.FirebaseManager) {
                try {
                    const currentSettings = await window.FirebaseManager.loadSettings() || {};
                    const updatedSettings = {
                        ...currentSettings,
                        postersData,
                        updatedAt: new Date()
                    };
                    await window.FirebaseManager.saveSettings(updatedSettings);
                    console.log('宣傳畫報已保存到 Firebase');
                } catch (error) {
                    console.error('保存宣傳畫報失敗:', error);
                }
            }
        }

        // 平滑滾動功能
        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        // 手機版選單切換
        document.getElementById('mobile-menu-btn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenu.classList.toggle('hidden');
        });

        // 滾動動畫效果
        function handleScrollAnimation() {
            const elements = document.querySelectorAll('.fade-in');
            elements.forEach(element => {
                const elementTop = element.getBoundingClientRect().top;
                const elementVisible = 150;
                
                if (elementTop < window.innerHeight - elementVisible) {
                    element.classList.add('visible');
                }
            });
        }

        // 導航欄背景變化
        function handleNavbarScroll() {
            const navbar = document.querySelector('nav');
            if (window.scrollY > 50) {
                navbar.classList.add('shadow-lg');
            } else {
                navbar.classList.remove('shadow-lg');
            }
        }

        // 導航連結點擊處理
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                scrollToSection(targetId);
                
                // 關閉手機版選單
                const mobileMenu = document.getElementById('mobile-menu');
                mobileMenu.classList.add('hidden');
            });
        });

        // 滾動事件監聽
        window.addEventListener('scroll', function() {
            handleScrollAnimation();
            handleNavbarScroll();
        });

        // 頁面載入完成後執行
        window.addEventListener('load', function() {
            handleScrollAnimation();
        });

        // 主題配置
        const themes = {
            classic: {
                name: '經典藍色',
                primary: '#2563eb',
                secondary: '#06b6d4',
                accent: '#3b82f6',
                heroGradient: 'linear-gradient(135deg, #1e3a8a 0%, #3b82f6 50%, #06b6d4 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            },
            nature: {
                name: '自然綠色',
                primary: '#059669',
                secondary: '#10b981',
                accent: '#34d399',
                heroGradient: 'linear-gradient(135deg, #064e3b 0%, #059669 50%, #10b981 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            },
            elegant: {
                name: '優雅紫色',
                primary: '#7c3aed',
                secondary: '#a855f7',
                accent: '#c084fc',
                heroGradient: 'linear-gradient(135deg, #581c87 0%, #7c3aed 50%, #a855f7 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            },
            warm: {
                name: '溫馨橙色',
                primary: '#ea580c',
                secondary: '#f97316',
                accent: '#fb923c',
                heroGradient: 'linear-gradient(135deg, #c2410c 0%, #ea580c 50%, #f97316 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            },
            modern: {
                name: '現代灰色',
                primary: '#4b5563',
                secondary: '#6b7280',
                accent: '#9ca3af',
                heroGradient: 'linear-gradient(135deg, #374151 0%, #4b5563 50%, #6b7280 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            },
            vibrant: {
                name: '活力紅色',
                primary: '#dc2626',
                secondary: '#ef4444',
                accent: '#f87171',
                heroGradient: 'linear-gradient(135deg, #991b1b 0%, #dc2626 50%, #ef4444 100%)',
                cardBg: '#ffffff',
                textPrimary: '#1f2937',
                textSecondary: '#6b7280'
            }
        };

        // 選擇主題
        function selectTheme(themeName) {
            currentTheme = themeName;
            const theme = themes[themeName];
            
            // 更新主題選擇視覺效果
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('border-blue-400', 'border-green-400', 'border-purple-400', 'border-orange-400', 'border-gray-400', 'border-red-400');
                option.classList.add('border-gray-200');
            });
            
            const selectedOption = document.querySelector(`[data-theme="${themeName}"]`);
            if (selectedOption) {
                selectedOption.classList.remove('border-gray-200');
                const colorMap = {
                    classic: 'border-blue-400',
                    nature: 'border-green-400',
                    elegant: 'border-purple-400',
                    warm: 'border-orange-400',
                    modern: 'border-gray-400',
                    vibrant: 'border-red-400'
                };
                selectedOption.classList.add(colorMap[themeName]);
            }
            
            // 更新目前主題顯示
            document.getElementById('current-theme-name').textContent = theme.name;
            
            // 更新顏色選擇器
            document.getElementById('primary-color').value = theme.primary;
            document.getElementById('secondary-color').value = theme.secondary;
            
            // 立即應用主題
            applyTheme(theme);
        }

        // 應用主題
        function applyTheme(theme) {
            // 更新主視覺區背景
            const heroSection = document.querySelector('#home');
            if (heroSection) {
                heroSection.style.background = theme.heroGradient;
            }
            
            // 更新所有主要按鈕顏色
            updateButtonColors(theme);
            
            // 更新導航欄連結顏色
            updateNavColors(theme);
            
            // 更新卡片和元素顏色
            updateElementColors(theme);
        }

        // 更新按鈕顏色
        function updateButtonColors(theme) {
            // 主要按鈕
            const primaryButtons = document.querySelectorAll('.bg-blue-600');
            primaryButtons.forEach(btn => {
                btn.style.backgroundColor = theme.primary;
                btn.style.borderColor = theme.primary;
                
                // 移除舊的 hover 事件
                const newBtn = btn.cloneNode(true);
                btn.parentNode.replaceChild(newBtn, btn);
                
                newBtn.addEventListener('mouseenter', () => {
                    newBtn.style.backgroundColor = adjustBrightness(theme.primary, -20);
                });
                newBtn.addEventListener('mouseleave', () => {
                    newBtn.style.backgroundColor = theme.primary;
                });
            });
            
            // 浮動按鈕
            const floatingBtn = document.querySelector('.floating-btn');
            if (floatingBtn) {
                floatingBtn.style.backgroundColor = theme.primary;
                floatingBtn.addEventListener('mouseenter', () => {
                    floatingBtn.style.backgroundColor = adjustBrightness(theme.primary, -20);
                });
                floatingBtn.addEventListener('mouseleave', () => {
                    floatingBtn.style.backgroundColor = theme.primary;
                });
            }
        }

        // 更新導航欄顏色
        function updateNavColors(theme) {
            // 移除舊的樣式
            const oldStyle = document.getElementById('theme-nav-style');
            if (oldStyle) {
                oldStyle.remove();
            }
            
            // 添加新的樣式
            const style = document.createElement('style');
            style.id = 'theme-nav-style';
            style.textContent = `
                .nav-link:hover {
                    color: ${theme.primary} !important;
                }
                .nav-link::after {
                    background-color: ${theme.primary} !important;
                }
            `;
            document.head.appendChild(style);
        }

        // 更新元素顏色
        function updateElementColors(theme) {
            // 移除舊的樣式
            const oldStyle = document.getElementById('theme-element-style');
            if (oldStyle) {
                oldStyle.remove();
            }
            
            // 添加新的樣式
            const style = document.createElement('style');
            style.id = 'theme-element-style';
            style.textContent = `
                .text-blue-600 {
                    color: ${theme.primary} !important;
                }
                .text-cyan-300 {
                    color: ${theme.accent} !important;
                }
                .bg-blue-100 {
                    background-color: ${adjustBrightness(theme.primary, 85)} !important;
                }
                .bg-blue-50 {
                    background-color: ${adjustBrightness(theme.primary, 92)} !important;
                }
                .border-blue-600 {
                    border-color: ${theme.primary} !important;
                }
                .focus\\:ring-blue-500:focus {
                    --tw-ring-color: ${theme.primary} !important;
                }
            `;
            document.head.appendChild(style);
        }

        // 調整顏色亮度
        function adjustBrightness(hex, percent) {
            // 移除 # 符號
            hex = hex.replace('#', '');
            
            // 轉換為 RGB
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            
            // 調整亮度
            const factor = percent / 100;
            const newR = Math.max(0, Math.min(255, factor > 0 ? r + (255 - r) * factor : r * (1 + factor)));
            const newG = Math.max(0, Math.min(255, factor > 0 ? g + (255 - g) * factor : g * (1 + factor)));
            const newB = Math.max(0, Math.min(255, factor > 0 ? b + (255 - b) * factor : b * (1 + factor)));
            
            // 轉換回 hex
            return `#${Math.round(newR).toString(16).padStart(2, '0')}${Math.round(newG).toString(16).padStart(2, '0')}${Math.round(newB).toString(16).padStart(2, '0')}`;
        }

        // 套用樣式變更
        async function applyStyleChanges() {
            const applyStyleLoading = document.getElementById('apply-style-loading');
            applyStyleLoading.classList.remove('hidden');
            
            try {
                // 收集樣式設置
                const styleSettings = {
                    theme: currentTheme,
                    primaryColor: document.getElementById('primary-color').value,
                    secondaryColor: document.getElementById('secondary-color').value,
                    heroTitleSize: document.getElementById('hero-title-size').value,
                    sectionTitleSize: document.getElementById('section-title-size').value,
                    buttonRadius: document.getElementById('button-radius').value,
                    buttonSize: document.getElementById('button-size').value,
                    cardRadius: document.getElementById('card-radius').value,
                    cardShadow: document.getElementById('card-shadow').value
                };

                // 應用自訂顏色（如果與主題不同）
                const currentThemeConfig = themes[currentTheme];
                if (styleSettings.primaryColor !== currentThemeConfig.primary || 
                    styleSettings.secondaryColor !== currentThemeConfig.secondary) {
                    
                    const customTheme = {
                        ...currentThemeConfig,
                        primary: styleSettings.primaryColor,
                        secondary: styleSettings.secondaryColor,
                        accent: styleSettings.primaryColor,
                        heroGradient: `linear-gradient(135deg, ${adjustBrightness(styleSettings.primaryColor, -30)} 0%, ${styleSettings.primaryColor} 50%, ${styleSettings.secondaryColor} 100%)`
                    };
                    
                    applyTheme(customTheme);
                }

                // 應用字體大小變更
                applyFontSizes(styleSettings);
                
                // 應用按鈕和卡片樣式
                applyComponentStyles(styleSettings);

                // 保存到 Firebase
                if (window.FirebaseManager) {
                    const currentSettings = await window.FirebaseManager.loadSettings() || {};
                    const updatedSettings = {
                        ...currentSettings,
                        styleSettings,
                        updatedAt: new Date()
                    };
                    await window.FirebaseManager.saveSettings(updatedSettings);
                }

                alert('樣式設置已套用！');
                
            } catch (error) {
                console.error('套用樣式變更失敗:', error);
                alert('套用樣式變更時發生錯誤：' + error.message);
            } finally {
                applyStyleLoading.classList.add('hidden');
            }
        }

        // 應用字體大小
        function applyFontSizes(settings) {
            // 更新主標題字體大小
            const heroTitle = document.querySelector('#home h1');
            if (heroTitle) {
                heroTitle.className = heroTitle.className.replace(/text-\d+xl/g, '').replace(/md:text-\d+xl/g, '');
                const sizes = settings.heroTitleSize.split(' ');
                heroTitle.classList.add(...sizes);
            }
            
            // 更新區塊標題字體大小
            const sectionTitles = document.querySelectorAll('section h2');
            sectionTitles.forEach(title => {
                title.className = title.className.replace(/text-\d+xl/g, '');
                title.classList.add(settings.sectionTitleSize);
            });
        }

        // 應用組件樣式
        function applyComponentStyles(settings) {
            // 更新按鈕樣式
            const buttons = document.querySelectorAll('button:not(.theme-option):not(.settings-tab)');
            buttons.forEach(btn => {
                // 移除舊的圓角和大小類別
                btn.className = btn.className.replace(/rounded-\w+/g, '').replace(/px-\d+/g, '').replace(/py-\d+/g, '');
                btn.classList.add(settings.buttonRadius);
                const sizes = settings.buttonSize.split(' ');
                btn.classList.add(...sizes);
            });
            
            // 更新卡片樣式
            const cards = document.querySelectorAll('.card-hover, .bg-white.rounded-xl, .bg-white.rounded-lg');
            cards.forEach(card => {
                card.className = card.className.replace(/rounded-\w+/g, '').replace(/shadow-\w+/g, '');
                card.classList.add(settings.cardRadius, settings.cardShadow);
            });
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'96b64159828f095a',t:'MTc1NDU2NDI2OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
